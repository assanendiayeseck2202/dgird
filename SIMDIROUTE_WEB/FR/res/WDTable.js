/*! VersionVI: 30F190056s x */
function WDCacheRequete(n){this.m_oChampTable=n,this.m_oDate=new Date}function WDTableCacheLigneModifie(n){this.m_oCacheLigne=n,this.m_oCacheLigne.m_oLigneHTML.SwapLigneCache(this.m_oCacheLigne.m_nColonneHTML,this),this.m_tabValeursChaine=new Array(n.m_tabValeurs.length),this.m_tabValeursEntier=new Array(n.m_tabValeurs.length)}function WDTableCacheLigne(n,t,i){var u,e,o,s,f;if(n){this.m_sStyleCouleur=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_STYLE_COULEUR,""),this.m_sStyleCouleurFond=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_STYLE_COULEURF,""),this.m_sCleEnreg=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_CLEENREG,""),this.m_nPosAbsolue=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LIGNE_POSABSOLUE,i),u=n.getElementsByTagName(this.XML_RUPTURES),u&&u.length&&(this.m_oValeursRuptures={},e=u[0].getElementsByTagName(this.XML_RUPTURES_HAUT),e&&e.length&&(this.m_oValeursRuptures.m_sHaut=clWDAJAXMain.sXMLGetValeur(e[0])),o=u[0].getElementsByTagName(this.XML_RUPTURES_BAS),o&&o.length&&(this.m_oValeursRuptures.m_sBas=clWDAJAXMain.sXMLGetValeur(o[0])));for(var h=n.childNodes,c=h.length-(this.m_oValeursRuptures?1:0),l=new Array(c),r=0;r<c;r++)s=h[r],f={},f.m_sStyleCouleur=clWDAJAXMain.sXMLGetAttributSafe(s,this.XML_STYLE_COULEUR,""),f.m_sStyleCouleurFond=clWDAJAXMain.sXMLGetAttributSafe(s,this.XML_STYLE_COULEURF,""),this._vPlaceXMLDansCellule(s,f,r,t),l[r]=f;this.m_tabValeurs=l}}function Segment(n,t,i){if(this.m_nDebut=n,this.m_nTaille=t,this.m_nDebut<0&&this.m_nDebut!=-1&&this.m_nTaille!=-1&&(this.m_nTaille!=0&&(this.m_nTaille+=this.m_nDebut),this.m_nDebut=0),i>=0){if(this.m_nDebut>=i){delete this.m_nDebut,delete this.m_nTaille;return}this.m_nDebut+this.m_nTaille>i&&this.m_nTaille!=0&&(this.m_nTaille=i-this.m_nDebut)}}function WDTableCache(n,t){n&&(this.RecalculeMarges(n),this.m_fCacheLigne=t,this.m_tabLignes=[],this.m_tabRequetes=[])}function WDTableAJAXColonne(n,t){if(arguments.length){var r=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_ALIAS,"ALIAS"),u=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_TYPEWL,16),i=[clWDAJAXMain.nXMLGetAttributSafe(n,clWDAJAXMain.XML_CHAMP_ATT_TYPE,WDChamp.prototype.ms_nIDObjetSaisie),clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_TRI),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_RECHERCHE),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_FILTRE),clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_VISIBLE),clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_SAISISSABLE),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_DEPLACE,0),t,clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_POSAFFICHE,t),clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LARGEUR,undefined),clWDAJAXMain.tabXMLGetTableauValeur(n,"OPTION"),[],clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_AJUSTABLE),undefined,undefined];WDTableColonne.prototype.constructor.apply(this,[r,u,i]),this.m_sBulle=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_BULLE,null);switch(i[0]){case WDChamp.prototype.ms_nIDObjetCombo:break;case WDChamp.prototype.ms_nIDObjetInterrupteur:break;default:this.m_eTypeIDObjet=WDChamp.prototype.ms_nIDObjetSaisie;case WDChamp.prototype.ms_nIDObjetImage:case WDChamp.prototype.ms_nIDObjetSaisie:this.m_nLien=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_LIEN,0),this.m_nLien!=0&&(this.m_nEtatLien=clWDAJAXMain.nXMLGetAttributSafe(n,this.XML_ETATLIEN,0))}}}function WDEtatLigne(n,t){if(n){this.m_oLignePhysique=n.oGetIDElement(t),this.m_nLigneHTML=t;var i,r=n.vnGetNbLignesLogiquesParLignePhysique();for(this.m_tabLignesLogiques=new Array(r),i=0;i<r;i++)this.m_tabLignesLogiques[i]={m_oLigneCache:null,m_oLigneLogique:r>1?n.oGetIDElement(t,i):this.m_oLignePhysique,m_bJamaisAffiche:!n.vbZR()||n.bGetSansLimite()&&1<n.vnGetNbLignesLogiquesParLignePhysique()&&0<n.nGetNbRuptures()};this.m_tabCacheCelluleHTML=[],this.RecalculeObjetsRuptures(n,t)}}function WDEtatLignes(n,t){if(n){var i,r=t;for(this.m_tabEtatLignes=new Array(t),i=0;i<r;i++)this.m_tabEtatLignes[i]=new WDEtatLigne(n,i)}}function WDTable(n,t,i,r,u,f,e,o){arguments.length&&(WDChamp.prototype.constructor.apply(this,[n,undefined,undefined]),this.m_eCacheLimite=t,this.m_nHauteurLigne=i,this.bGetSansLimite()||(this.m_nPagesMargeMin=r,this.m_nPagesMargeMax=u,this.m_nPagesMargeRequete=parseInt((u+r)/2,10)),this.m_nTypeSelection=f,this.m_tabStyle=e,o&&(this.m_tabFleches=o.splice(3,1)[0],this.m_oPopupSaisieTRF=new WDPopupSaisieTRF(this,o)),this.m_oStyleCacheLargeur=new WDStyleCache(!0),this.m_oStyleCacheLargeur.Creation(),this.m_oStyleCacheLargeur.CreationFin(),this.m_tabImagesNonAffichee=[],this.m_nNbInits=0)}function WDCelluleAJAXSaisie(){arguments.length&&WDCelluleSaisie.prototype.constructor.apply(this,arguments)}if(WDCacheRequete.prototype={m_nColonneTri:-1,m_nLigne:-1,m_nIdRequeteAJAX:undefined,sCommandeAjax_LignesTable:"LIGNESTABLE",sCommandeAjax_LignesTriTable:"LIGNESTRITABLE",sCommandeAjax_ParCourtAP:"PARCOURTAP",sCommandeAjax_RechercheTable:"RECHERCHETABLE",sCommandeAjax_FiltreTable:"FILTRETABLE",sCommandeAjax_AnnuleFiltreTable:"ANNULEFILTRETABLE",sCommandeAjax_DeplaceColonne:"DEPLACECOLONNE",sCommandeAjax_ModifTable:"MODIFTABLE",sParametreAjax_ColonneLien:"WD_TABLE_COL_LIEN_",sParametreAjax_Debut:"WD_TABLE_DEBUT_",sParametreAjax_Nombre:"WD_TABLE_NOMBRE_",sParametreAjax_CleEnreg:"WD_TABLE_CLEENREG_",sParametreAjax_CleEnreg_Pos:"WD_TABLE_CLEENREG_POS_",sParametreAjax_CleEnregAP:"WD_TABLE_CLEENREGAP_",sParametreAjax_CleEnregAP_Pos:"WD_TABLE_CLEENREGAP_POS_",sParametreAjax_TriAWP:"WD_TABLE_TRIAWP_",sParametreAjax_ColTri:"WD_TABLE_COL_TRI_",sParametreAjax_Recherche_Marge:"WD_TABLE_RECHERCHE_MARGE_",sParametreAjax_Recherche_Nombre:"WD_TABLE_RECHERCHE_NOMBRE_",sParametreAjax_Recherche_Col:"WD_TABLE_RECHERCHE_COL_",sParametreAjax_Recherche_Valeur:"WD_TABLE_RECHERCHE_VAL_",sParametreAjax_Deplace_Col:"WD_TABLE_DEPLACE_COLONNE_",sParametreAjax_Deplace_Pos:"WD_TABLE_DEPLACE_POSITION_",sParametreAjax_Filtre_Filtre:"WD_TABLE_FILTRE_FILTRE_",_sGetNomChamp:function(){return encodeURIComponent(this.m_oChampTable.m_sAliasChamp)},sConstuitAWP:function(n){var t=this.sConstuitPosAP(),r,i,u;return clWDAJAXMain.m_bPageAWP&&(this.m_oChampTable.m_nColonneTriePre>-1&&(t+="&"+this.sParametreAjax_TriAWP+"="+encodeURIComponent((this.m_oChampTable.m_bTriCroissantPre?"+":"-")+this.m_oChampTable.m_nColonneTriePre)),r=this.m_oChampTable.oGetElementByName(document,"_DATA"),r&&(i=r.value,i&&i.length&&(t+="&"+this._sGetNomChamp()+"_DATA="+encodeURIComponent(i))),n||(u=clWDAJAXMain.sConstruitValeurChamp(this.m_oChampTable.m_oChampFormulaireSelAWP),u.length&&(t+="&"+u))),t},sConstuitPosAP:function(){return this.m_oChampTable.m_sCleParcourtAP.length==0?"":"&"+this.sParametreAjax_CleEnregAP_Pos+"="+this.m_oChampTable.m_nNbLignes+"&"+this.sParametreAjax_CleEnregAP+"="+encodeURIComponent(this.m_oChampTable.m_sCleParcourtAP)},sConstuitRequeteRechercheTable:function(n,t,i){var r=this.sCommandeAjax_RechercheTable+"="+this._sGetNomChamp();return r+="&"+this.sParametreAjax_Recherche_Marge+"="+t,r+="&"+this.sParametreAjax_Recherche_Nombre+"="+n,r+="&"+this.sParametreAjax_Recherche_Col+"="+this.m_nColonneTri,r+="&"+this.sParametreAjax_Recherche_Valeur+"="+encodeURIComponent(i),r+=this.sConstuitAWP(!1)},sConstuitRequeteFiltreTable:function(n,t,i,r,u){var f=this.sCommandeAjax_FiltreTable+"="+this._sGetNomChamp();return f+="&"+this.sParametreAjax_Recherche_Marge+"="+t,f+="&"+this.sParametreAjax_Recherche_Nombre+"="+n,f+="&"+this.sParametreAjax_Recherche_Col+"="+i,f+="&"+this.sParametreAjax_Filtre_Filtre+"="+r,f+="&"+this.sParametreAjax_Recherche_Valeur+"="+encodeURIComponent(u),f+=this.sConstuitAWP(!1)},sConstuitRequeteAnnuleFiltreTable:function(n,t,i){var r=this.sCommandeAjax_AnnuleFiltreTable+"="+this._sGetNomChamp();return r+="&"+this.sParametreAjax_Recherche_Marge+"="+t,r+="&"+this.sParametreAjax_Recherche_Nombre+"="+n,r+="&"+this.sParametreAjax_Recherche_Col+"="+i,r+=this.sConstuitAWP(!1)},sConstuitRequeteDeplaceColonneTable:function(n,t){var i=this.sCommandeAjax_DeplaceColonne+"="+this._sGetNomChamp();return i+="&"+this.sParametreAjax_Deplace_Col+"="+n,i+="&"+this.sParametreAjax_Deplace_Pos+"="+t,i+=this.sConstuitAWP(!1)},sConstuitRequeteLignesTable:function(n,t,i){var r="";return this.m_oSegment.m_nDebut!=-1&&this.m_oSegment.m_nTaille!=-1?(r=(this.m_nColonneTri>-1?this.sCommandeAjax_LignesTriTable:this.sCommandeAjax_LignesTable)+"="+this._sGetNomChamp(),r+="&"+this.m_oSegment.m_nDebut+"="+this.m_oSegment.m_nTaille,this.m_nColonneTri>=0&&(r+="&"+this.sParametreAjax_ColTri+"="+(n?"":"-")+this.m_nColonneTri)):r=this.sCommandeAjax_ParCourtAP+"="+this._sGetNomChamp(),r+=this.sConstuitAWP(!1),i.length>0&&(r+="&"+this.sParametreAjax_CleEnreg_Pos+"="+t,r+="&"+this.sParametreAjax_CleEnreg+"="+encodeURIComponent(i)),r},sConstuitRequeteModifLigne:function(n,t,i){var u=this.sCommandeAjax_ModifTable+"="+this._sGetNomChamp(),f,r,e;if(u+="&LIGNE="+this.m_nLigne,i.length>0&&(u+="&"+this.sParametreAjax_CleEnreg+"="+encodeURIComponent(i)),u+=this.sConstuitAWP(!1),n)""!=t&&(u+="&"+t);else{for(f=new Array(t.length),e=t.length,r=0;r<e;r++)f[r]=t[r].m_nValeur!==undefined&&t[r].m_nValeur!==-1?"C"+r+"="+t[r].m_nValeur:"C"+r+"="+encodeURIComponent(t[r].m_sValeur);u+="&"+f.join("&")}return u},sConstuitRequeteSelection:function(n,t,i,r){var u=this.sParametreAjax_Debut+"="+t+"&"+this.sParametreAjax_Nombre+"="+i;return u+="&"+this.sParametreAjax_ColonneLien+"="+(n!=-1?n+1:""),r.length>0&&(u+="&"+this.sParametreAjax_CleEnreg+"="+encodeURIComponent(r)),u+=this.sConstuitAWP(!0)},sConstuitRequeteEnrouleDeroule:function(){return this.sConstuitAWP(!1)},bEnvoiRequete:function(n,t){var i=n.apply(this,t);return i!==!1?(this.m_nIdRequeteAJAX=i,!0):!1},nEnvoiRequete:function(n,t,i,r,u){return this.m_oSegment=n,this.m_nColonneTri=t,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteLignesTable(i,r,u))},nEnvoiRequeteRecherche:function(n,t,i,r){return this.m_nColonneTri=i,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteRechercheTable(n,t,r))},nEnvoiRequeteFiltre:function(n,t,i,r,u){return clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteFiltreTable(n,t,i,r,u))},nEnvoiRequeteAnnuleFiltre:function(n,t,i){return clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteAnnuleFiltreTable(n,t,i))},nEnvoiRequeteDeplaceColonne:function(n,t){return clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteDeplaceColonneTable(n,t))},nEnvoiRequeteModifLigne:function(n,t,i,r){return this.m_nLigne=n,clWDAJAXMain.nAJAXRecupereLignesTable(this,this.sConstuitRequeteModifLigne(t,i,r))},nEnvoiRequeteSelection:function(n,t,i,r){var u=n!=-1?this.m_oChampTable.nColonneLien(n)==2:!1;return clWDAJAXMain.nAJAXRecupereLignesTableSelection(this,this.sConstuitRequeteSelection(n,t,i,r),u)},nEnvoiRequeteEnrouleDeroule:function(n){return clWDAJAXMain.nAJAXRecupereLignesTableEnrouleDeroule(this,n,this.sConstuitRequeteEnrouleDeroule())},ActionListe:function(n){if(this.m_oChampTable){var t=this.m_oChampTable;this.SupprimeRequete(!1),t.bActionListeDepuisAJAX(n,this.m_nLigne)}},bEstValide:function(){return+new Date-this.m_oDate.getTime()<=1e4},SupprimeRequete:function(n){var t=this.m_oChampTable;undefined!==t&&(t.m_oCache.SupprimeRequete(this),n&&t.nSetTimeoutUnique("Reinit",2e3))}},WDTableCacheLigneModifie.prototype.bLigneVirtuelle=!0,WDTableCacheLigneModifie.prototype.vnGetLigneHTML=function(){return this.m_oCacheLigne.vnGetLigneHTML.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.vnGetColonneHTML=function(){return this.m_oCacheLigne.vnGetColonneHTML.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.vnGetPosAbsolue=function(){return this.m_oCacheLigne.vnGetPosAbsolue.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.oGetValeurCellule=function(n,t){return this.m_tabValeursChaine[n]?t?this.m_tabValeursEntier[n]:this.m_tabValeursChaine[n]:this.m_oCacheLigne.oGetValeurCellule.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.SetValeurCellule=function(n,t,i){n<this.m_tabValeursChaine.length&&(this.m_tabValeursChaine[n]=t,this.m_tabValeursEntier[n]=i)},WDTableCacheLigneModifie.prototype.tabContenuCellule=function(){return this.m_oCacheLigne.tabContenuCellule.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.sGetCleEnreg=function(){return this.m_oCacheLigne.sGetCleEnreg.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.vbMAJLigne=function(n,t,i,r){return this.m_oCacheLigne.vbMAJLigne.apply(this.m_oCacheLigne,[n,t,this.m_tabValeursChaine,r])},WDTableCacheLigneModifie.prototype.DetacheEtVide=function(n){this.m_oCacheLigne.DetacheEtVide(n)},WDTableCacheLigneModifie.prototype.ValideChangement=function(n,t,i){for(var f=!1,u=this.m_tabValeursChaine,e=this.m_tabValeursEntier,o=u.length,r=0;r<o;r++)u[r]!==undefined&&(f|=this.m_oCacheLigne.bChangementValeur(r,u[r],e[r]));f&&t.CreeRequeteModifLigne(n,i,!1,this.m_oCacheLigne.m_tabValeurs)},WDTableCacheLigneModifie.prototype.bSetHauteur=function(){return this.m_oCacheLigne.bSetHauteur.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.nGetHauteur=function(){return this.m_oCacheLigne.nGetHauteur.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigneModifie.prototype.SetStyle=function(){return this.m_oCacheLigne.SetStyle.apply(this.m_oCacheLigne,arguments)},WDTableCacheLigne.prototype.XML_STYLE_COULEUR="COULEUR",WDTableCacheLigne.prototype.XML_STYLE_COULEURF="COULEURFOND",WDTableCacheLigne.prototype.XML_CLEENREG="CLEENREG",WDTableCacheLigne.prototype.XML_LIGNE_POSABSOLUE="POSABSOLUE",WDTableCacheLigne.prototype.XML_RUPTURES="RUPTURES",WDTableCacheLigne.prototype.XML_RUPTURES_HAUT="HAUT",WDTableCacheLigne.prototype.XML_RUPTURES_BAS="BAS",WDTableCacheLigne.prototype.m_oVide={m_sValeur:"",m_sStyleCouleur:"",m_sStyleCouleurFond:"",m_nValeur:-1,m_sCleEnreg:""},WDTableCacheLigne.prototype.m_nValeur=-1,WDTableCacheLigne.prototype.m_nHauteur=-1,WDTableCacheLigne.prototype._vPlaceXMLDansCellule=function(n,t,i,r){var u,f;t.m_sValeur=clWDAJAXMain.sXMLGetValeur(n);switch(r.eColonneTypeIDObjet(i)){case WDChamp.prototype.ms_nIDObjetCombo:u=clWDAJAXMain.tabXMLGetTableauValeur(n,"OPTION"),u||(u=r.tabColonneCombo(i)),t.m_tabOptions=u,u?(f=clWDUtil.nDansTableau(u,t.m_sValeur),clWDUtil.nElementInconnu!=f&&(t.m_nValeur=f)):t.m_nValeur=-1;break;case WDChamp.prototype.ms_nIDObjetInterrupteur:t.m_nValeur=parseInt(t.m_sValeur,10)}},WDTableCacheLigne.prototype.vnGetLigneHTML=function(n){return n},WDTableCacheLigne.prototype.vnGetColonneHTML=function(){return 0},WDTableCacheLigne.prototype.vnGetPosAbsolue=function(){return this.m_nPosAbsolue},WDTableCacheLigne.prototype.vnGetNbReplieesOuEnroulees=function(){return 0},WDTableCacheLigne.prototype.oGetValeurCellule=function(n,t){var i=n<this.m_tabValeurs.length?this.m_tabValeurs[n]:this.m_oVide;return t?i.m_nValeur:i.m_sValeur},WDTableCacheLigne.prototype.tabContenuCellule=function(n){return this.m_tabValeurs[n].m_tabOptions},WDTableCacheLigne.prototype.sGetCleEnreg=function(){return this.m_sCleEnreg},WDTableCacheLigne.prototype.vbMAJLigne=function(n,t,i,r){var h=n.vbLigneEstSelectionneeSansZR(t),e,c,o,s;if(!this.m_oLigneHTML)return!1;e=this.vnGetColonneHTML(),c=this.m_oLigneHTML.oGetLigneLogiqueHTML(e),this.SetCouleurObjet(n.m_sCSSTexteStyleSelectionCouleurFond,c,h,this);for(var l=this.m_tabValeurs,f=-1,a=l.length,u;(u=this.m_oLigneHTML.oGetCellule(e,++f,n))||f<a;)u&&(o=f<a?l[f]:this.m_oVide,s=o.m_sValeur,i&&undefined!==i[f]&&(s=i[f]),n.vRemplitCellule(u,s,t,f,this,r),u=u.parentNode,!n.vbZR()&&n.bGetHauteurLigneVariable()&&(u=u.parentNode),this.SetCouleurObjet(n.m_sCSSTexteStyleSelectionCouleurFond,u,h,o));return n.RemplitRuptures(this.m_oLigneHTML,e,this.m_oValeursRuptures),!0},WDTableCacheLigne.prototype.DetacheEtVide=function(n){this.m_oLigneHTML&&this.m_oLigneHTML.DetacheEtVide(this.m_nColonneHTML,n)},WDTableCacheLigne.prototype.SetValeurCellule=clWDUtil.m_pfVide,WDTableCacheLigne.prototype.SetCouleurObjet=function(n,t,i,r){var f=r.m_sStyleCouleurFond,u;i&&undefined!=n&&(f=n),u=t.style,u.color!=r.m_sStyleCouleur&&(u.color=r.m_sStyleCouleur),u.backgroundColor!=f&&(u.backgroundColor=f)},WDTableCacheLigne.prototype.bChangementValeur=function(n,t,i){var r=this.m_tabValeurs;return n<r.length&&!(r[n].m_sValeur===t)?(r[n].m_sValeur=t,r[n].m_nValeur=i,!0):!1},WDTableCacheLigne.prototype.bSetHauteur=function(n){var t=this.m_nHauteur;return this.m_nHauteur=n,t!==n},WDTableCacheLigne.prototype.nGetHauteur=function(){return this.m_nHauteur},WDTableCacheLigne.prototype.SetStyle=function(n,t,i,r,u){this.m_oLigneHTML&&(this.m_oLigneHTML.SetStyle(t,this.m_nColonneHTML,n),t.vbZR()||this.m_oLigneHTML.bMAJSiPlein(this.m_nColonneHTML,t,i,r,u))},Segment.prototype.m_nDebut=-1,Segment.prototype.m_nTaille=0,Segment.prototype.bIntersecte=function(n){return this.m_nDebut==-1||this.m_nTaille<=0?!0:n&&n.m_nTaille==0?(delete this.m_nDebut,delete this.m_nTaille,!0):!n||n.m_nDebut==-1||n.m_nTaille<=0?!1:this.m_nDebut>=n.m_nDebut&&this.m_nDebut+this.m_nTaille<=n.m_nDebut+n.m_nTaille?(delete this.m_nDebut,delete this.m_nTaille,!0):this.m_nDebut<n.m_nDebut&&this.m_nDebut+this.m_nTaille>n.m_nDebut?(this.m_nTaille=n.m_nDebut-this.m_nDebut,!1):this.m_nDebut>=n.m_nDebut&&this.m_nDebut<n.m_nDebut+n.m_nTaille&&this.m_nDebut+this.m_nTaille>n.m_nDebut+n.m_nTaille?(this.m_nTaille-=n.m_nDebut+n.m_nTaille-this.m_nDebut,this.m_nDebut=n.m_nDebut+n.m_nTaille,!1):!1},Segment.prototype.bEstVide=function(){return this.m_nTaille<0||this.m_nDebut<0&&this.m_nDebut+this.m_nTaille<=0},WDTableCache.prototype.m_nDebutCache=-1,WDTableCache.prototype.XML_LIGNE="LIGNE",WDTableCache.prototype.XML_LIGNE_NUMERO="NUMERO",WDTableCache.prototype.RecalculeMarges=function(n){if(!n.bGetSansLimite()){var t=n.m_nNbLignesPage,i=n.m_nPagesMargeMin,r=n.m_nPagesMargeMax,u=n.m_nPagesMargeRequete;this.m_nLignesMargeMinAvant=i*t,this.m_nLignesMargeMinTaille=(i*2+1)*t+2,this.m_nLignesMargeMaxAvant=r*t,this.m_nLignesMargeMaxApres=(r+1)*t+2,this.m_nLignesMargeRequeteAvant=Math.min(u*t,this.m_nLignesMargeMaxAvant),this.m_nLignesMargeRequeteTaille=Math.min((u*2+1)*t+2,this.m_nLignesMargeMaxAvant+this.m_nLignesMargeMaxApres)}},WDTableCache.prototype.bRemplitCache=function(n,t,i,r){var u,e,s,h,c,f,o;if(i>-1&&(this.m_tabLignes.length=0,delete this.m_nDebutCache),e=n.m_nDebut,n.bGetSansLimite())u=new Segment(0,0);else if(s=n.m_nNbLignes,h=new Segment(Math.max(0,e-this.m_nLignesMargeMinAvant),this.m_nLignesMargeMinTaille,t?-1:s),u=new Segment(Math.max(0,e-this.m_nLignesMargeRequeteAvant),this.m_nLignesMargeRequeteTaille,t?-1:s+this.m_nLignesMargeMinTaille),this.m_nDebutCache!=-1&&!t){if(c=new Segment(Math.max(0,this.m_nDebutCache),this.m_tabLignes.length),h.bIntersecte(c))return!1;if(this.bIntersecteAnciennesRequetes(h,i>-1))return!0;u.bIntersecte(c)}return this.bIntersecteAnciennesRequetes(u,i>-1)?!1:(f=-1,o="",clWDAJAXMain.m_bPageAWP&&(this.m_nDebutCache>=0&&!n.bGetSansLimite()&&(f=this.m_nDebutCache<u.m_nDebut?Math.min(this.m_nDebutCache+this.m_tabLignes.length-1,u.m_nDebut-1):Math.max(this.m_nDebutCache,u.m_nDebut+u.m_nTaille),o=this.sGetCleEnregLigne(f)),-1<e&&n.m_sCleDebut&&(f==-1||Math.abs(e-u.m_nDebut)<Math.abs(e-f))&&(f=e,o=n.m_sCleDebut)),this.CreeRequete(n,u,i,r,f,o),!0)},WDTableCache.prototype.bIntersecteAnciennesRequetes=function(n,t){this.PurgeAnciennesRequetes(t);for(var r=this.m_tabRequetes.length,i=0;i<r;i++)if(n.bIntersecte(this.m_tabRequetes[i].m_oSegment))return!0;return n.bEstVide()},WDTableCache.prototype.bEnvoiRequete=function(n,t,i){var r=new WDCacheRequete(t);return r.bEnvoiRequete(n,i)?(this.m_tabRequetes.push(r),!0):!1},WDTableCache.prototype.CreeRequete=function(n,t,i,r,u,f){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequete,n,[t,i,r,u,f])},WDTableCache.prototype.CreeRequeteRecherche=function(n,t,i){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteRecherche,n,[n.m_nNbLignesPage,this.m_nLignesMargeRequeteAvant?this.m_nLignesMargeRequeteAvant:0,t,i])},WDTableCache.prototype.CreeRequeteFiltre=function(n,t,i,r){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteFiltre,n,[n.m_nNbLignesPage,this.m_nLignesMargeRequeteAvant?this.m_nLignesMargeRequeteAvant:0,t,i,r])},WDTableCache.prototype.CreeRequeteAnnuleFiltre=function(n,t){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteAnnuleFiltre,n,[n.m_nNbLignesPage,this.m_nLignesMargeRequeteAvant?this.m_nLignesMargeRequeteAvant:0,t])},WDTableCache.prototype.CreeRequeteDeplaceColonne=function(n,t,i){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteDeplaceColonne,n,[t,i])},WDTableCache.prototype.CreeRequeteModifLigne=function(n,t,i,r){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteModifLigne,n,[t,i,r,this.sGetCleEnregLigne(t)])},WDTableCache.prototype.CreeRequeteSelection=function(n,t){var i=this.m_nDebutCache,r=this.m_tabLignes.length;n.bGetSansLimite()&&1==n.m_tabSelection.length&&(i=n.m_tabSelection[0],r=1),this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteSelection,n,[t,i,r,this.sGetCleEnregLigne(this.m_nDebutCache)])},WDTableCache.prototype.CreeRequeteEnrouleDeroule=function(n,t){this.bEnvoiRequete(WDCacheRequete.prototype.nEnvoiRequeteEnrouleDeroule,n,[t,this.sGetCleEnregLigne(t)])},WDTableCache.prototype.sGetCleEnregLigne=function(n){if(this.bDansPlageCache(n)){var t=this.m_tabLignes[n-this.m_nDebutCache];if(t)return t.sGetCleEnreg()}return""},WDTableCache.prototype.PurgeAnciennesRequetes=function(n){for(var r=this.m_tabRequetes.length,i,t=0;t<r;t++)(this.m_tabRequetes[t].bEstValide()==!1||n)&&(delete this.m_tabRequetes[t].m_oChampTable,i=clWDAJAXMain.GetWDAJAXRequete(this.m_tabRequetes[t].m_nIdRequeteAJAX),i!=null&&i.Annule(),delete i,this.m_tabRequetes.splice(t,1),t--,r--)},WDTableCache.prototype.SupprimeRequete=function(n){for(var i=this.m_tabRequetes.length,t=0;t<i;t++)if(this.m_tabRequetes[t].m_oDate.getTime()==n.m_oDate.getTime()&&this.m_tabRequetes[t].m_nIdRequeteAJAX==n.m_nIdRequeteAJAX){delete this.m_tabRequetes[t].m_oChampTable,this.m_tabRequetes.splice(t,1);return}},WDTableCache.prototype.bAvecRequeteTri=function(){for(var t=this.m_tabRequetes.length,n=0;n<t;n++)if(this.m_tabRequetes[n].m_nColonneTri>-1)return!0;return!1},WDTableCache.prototype.__nPlaceLigneCache=function(n,t){var u,i,r;if(!n.bGetSansLimite()&&(u=n.m_nDebut,t<u-this.m_nLignesMargeMaxAvant||t>=u+this.m_nLignesMargeMaxApres))return-1;if(this.m_nDebutCache==-1)return this.m_tabLignes.push(null),this.m_nDebutCache=t,0;if(t<this.m_nDebutCache){for(r=this.m_nDebutCache-t,i=0;i<r;i++)this.m_tabLignes.unshift(null);return this.m_nDebutCache=t,0}if(t>=this.m_nDebutCache+this.m_tabLignes.length)for(r=t-this.m_nDebutCache-this.m_tabLignes.length+1,i=0;i<r;i++)this.m_tabLignes.push(null);else t-this.m_nDebutCache<this.m_tabLignes.length&&this.m_tabLignes[t-this.m_nDebutCache]!=null&&(delete this.m_tabLignes[t-this.m_nDebutCache].m_tabValeurs,this.m_tabLignes[t-this.m_nDebutCache]=null);return t-this.m_nDebutCache},WDTableCache.prototype.RemplitCacheLignes=function(n,t){for(var o=this.bDansPlageCache(n.m_nDebut),r=t.firstChild,u,i,f,e;r!=null;){if(u=parseInt(clWDAJAXMain.sXMLGetAttribut(r,this.XML_LIGNE_NUMERO),10),i=this.__nPlaceLigneCache(n,u),i!=-1){if(this.m_tabLignes[i]=new this.m_fCacheLigne(r,n,u),f=this.m_tabLignes[i].vnGetNbReplieesOuEnroulees(),0<f)for(e=this.m_tabLignes[i].vnGetPosAbsolue()+f;this.m_tabLignes[i+1]&&this.m_tabLignes[i+1].vnGetPosAbsolue()<=e;)this.m_tabLignes.splice(i+1,1);o&&n.NoteMAJLigne(u)}r=r.nextSibling}},WDTableCache.prototype.SupprimeLignesInutiles=function(n){var t,i;if(this.m_nDebutCache!=-1){if(t=this.m_tabLignes,n.bGetSansLimite()){t.length>n.m_nNbLignes&&t.splice(n.m_nNbLignes);return}if(i=n.m_nDebut,this.m_nDebutCache+t.length<=i-this.m_nLignesMargeMaxAvant||this.m_nDebutCache>=i+this.m_nLignesMargeMaxApres){t.length=0,delete this.m_nDebutCache;return}for(this.m_nDebutCache<i-this.m_nLignesMargeMaxAvant&&(t.splice(0,i-this.m_nLignesMargeMaxAvant-this.m_nDebutCache),this.m_nDebutCache=i-this.m_nLignesMargeMaxAvant),this.m_nDebutCache+t.length>=i+this.m_nLignesMargeMaxApres&&t.splice(i-this.m_nDebutCache+this.m_nLignesMargeMaxApres),this.m_nDebutCache+t.length>n.m_nNbLignes&&t.splice(n.m_nNbLignes-this.m_nDebutCache);t.length&&!t[0];)t.splice(0,1),this.m_nDebutCache++;while(t.length&&!t[t.length-1])t.splice(t.length-1,1);0==t.length&&delete this.m_nDebutCache}},WDTableCache.prototype.oGetLigne=function(n){return this.bDansPlageCache(n)?this.m_tabLignes[n-this.m_nDebutCache]:null},WDTableCache.prototype.bMAJLigne=function(n,t,i){var r=this.oGetLigne(t);return r?r.vbMAJLigne(n,t,undefined,i):!1},WDTableCache.prototype.oGetValeurCellule=function(n,t,i){var r=this.oGetLigne(n);return r?r.oGetValeurCellule(t,i):i?-1:""},WDTableCache.prototype.tabContenuCellule=function(n,t){var i=this.oGetLigne(n);return i?i.tabContenuCellule(t):null},WDTableCache.prototype.bDansPlageCache=function(n){return n>=this.m_nDebutCache&&n<this.m_nDebutCache+this.m_tabLignes.length},WDTableCache.prototype.SetValeurCellule=function(n,t,i,r,u){if(this.m_nDebutCache!=-1){var f=n-this.m_nDebutCache;f<=this.m_tabLignes.length&&this.m_tabLignes[f]!=null&&this.m_tabLignes[f].SetValeurCellule(i,r,u)}},WDTableCache.prototype.ValideChangement=function(n,t){var i=this.m_tabLignes[t-this.m_nDebutCache];i&&i.bLigneVirtuelle&&i.ValideChangement(n,this,t)},WDTableCache.prototype.SupprimeLignesVirtuelles=function(){for(var i=this.m_tabLignes.length,n,t=0;t<i;t++)n=this.m_tabLignes[t],n&&n.bLigneVirtuelle&&(this.m_tabLignes[t]=n.m_oCacheLigne,n.m_oCacheLigne.m_oLigneHTML.SwapLigneCache(n.m_oCacheLigne.m_nColonneHTML,n.m_oCacheLigne),delete n.m_oCacheLigne,delete n.m_tabValeurs,delete n)},WDTableCache.prototype.bCreeLigneVirtuelle=function(n){var t=n-this.m_nDebutCache;return this.m_tabLignes[t]?(this.m_tabLignes[t].bLigneVirtuelle||(this.m_tabLignes[t]=new WDTableCacheLigneModifie(this.m_tabLignes[t])),!0):!1},WDTableCache.prototype.bSetHauteur=function(n,t){var i=this.oGetLigne(n);return i?i.bSetHauteur(t):!1},WDTableCache.prototype.nGetHauteur=function(n){var t=this.oGetLigne(n);return t?t.nGetHauteur():-1},WDTableCache.prototype.nPosAbsolue2PosVisible=function(n){var t,r,i;if(this.m_tabLignes.length==0||!this.m_tabLignes[0]||n<this.m_tabLignes[0].vnGetPosAbsolue()||!this.m_tabLignes[this.m_tabLignes.length-1]||n>this.m_tabLignes[this.m_tabLignes.length-1].vnGetPosAbsolue())return n;for(r=this.m_tabLignes.length,t=0;t<r;t++)if(i=this.m_tabLignes[t],i&&i.vnGetPosAbsolue()==n)return t+this.m_nDebutCache;return n},WDTableCache.prototype.nPosVisible2PosAbsolue=function(n){if(this.m_tabLignes.length==0)return n;var t=this.oGetLigne(n);return t?t.vnGetPosAbsolue():n},WDTableAJAXColonne.prototype=new WDTableColonne,WDTableAJAXColonne.prototype.constructor=WDTableAJAXColonne,WDTableAJAXColonne.prototype.m_nLien=0,WDTableAJAXColonne.prototype.m_nEtatLien=0,WDTableAJAXColonne.prototype.XML_ALIAS="ALIAS",WDTableAJAXColonne.prototype.XML_TYPEWL="TYPEWL",WDTableAJAXColonne.prototype.XML_SAISISSABLE="SAISISSABLE",WDTableAJAXColonne.prototype.XML_VISIBLE="VISIBLE",WDTableAJAXColonne.prototype.XML_LIEN="LIEN",WDTableAJAXColonne.prototype.XML_ETATLIEN="ETATLIEN",WDTableAJAXColonne.prototype.XML_BULLE="BULLE",WDTableAJAXColonne.prototype.XML_TRI="TRI",WDTableAJAXColonne.prototype.XML_RECHERCHE="RECHERCHE",WDTableAJAXColonne.prototype.XML_FILTRE="FILTRE",WDTableAJAXColonne.prototype.XML_LARGEUR="LARGEUR",WDTableAJAXColonne.prototype.XML_DEPLACE="DEPLACE",WDTableAJAXColonne.prototype.XML_POSAFFICHE="POSAFFICHE",WDTableAJAXColonne.prototype.XML_AJUSTABLE="AJUSTABLE",WDEtatLigne.prototype.oGetLigneLogique=function(n){return this.m_tabLignesLogiques[n]},WDEtatLigne.prototype.oGetLigneLogiqueHTML=function(n){return this.m_tabLignesLogiques[n].m_oLigneLogique},WDEtatLigne.prototype.oGetCellule=function(n,t,i){var r;if(this.m_tabLignesLogiques.length<=1)r=t;else if(t==0)r=n;else return null;return this.oGetCelluleHTML(i,r)},WDEtatLigne.prototype.RecalculeObjetsRuptures=function(n,t){n.nGetNbRuptures()>0&&(this.m_oRupturesHaut=n.oGetIDElement(WDTable.prototype.ID_RUPTURE_HAUT,t),this.m_oRupturesBas=n.oGetIDElement(WDTable.prototype.ID_RUPTURE_BAS,t))},WDEtatLigne.prototype.nInvalide=function(n,t,i,r){for(var f=this.m_tabLignesLogiques.length,u=0;u<f;u++)(this.bPlein(u)||i)&&(this.MasqueLigne(u,n,t,r,t%2==0?n.m_tabStyle[0]:n.m_tabStyle[1]),t++);return t},WDEtatLigne.prototype.SwapLigneCache=function(n,t){this.m_tabLignesLogiques[n].m_oLigneCache=t},WDEtatLigne.prototype.SetStyle=function(n,t,i){var r=this.oGetLigneLogiqueHTML(t);n.vbZR()&&(r=1<n.vnGetNbLignesLogiquesParLignePhysique()?r.parentNode:r.firstChild),r.className=i},WDEtatLigne.prototype.bPlein=function(n){return this.m_tabLignesLogiques[n].m_oLigneCache?!0:!1},WDEtatLigne.prototype.bJamaisAffiche=function bJamaisAffiche(n){var bJamaisAffiche=this.m_tabLignesLogiques[n].m_bJamaisAffiche;return bJamaisAffiche&&(this.m_tabLignesLogiques[n].m_bJamaisAffiche=!1),bJamaisAffiche},WDEtatLigne.prototype.bMAJSiPlein=function(n,t,i,r,u){var f=this.m_tabLignesLogiques[n].m_oLigneCache;return f?this.bMAJ(n,f,t,i,r,u):!1},WDEtatLigne.prototype.bMAJ=function(n,t,i,r,u,f){var e;return t?(this.AfficheLigne(n,t,i,r,u),e=t.vbMAJLigne(i,r,undefined,f)):(this.MasqueLigne(n,i,r,u),e=!0),i.vPostMAJLigne(r,u),e},WDEtatLigne.prototype.DetacheEtVide=function(n,t){this.Detache(n),t.vVideCellule(this,n)},WDEtatLigne.prototype.Detache=function(n){this.DetacheO(this.m_tabLignesLogiques[n])},WDEtatLigne.prototype.DetacheO=function(n){n.m_oLigneCache&&(delete n.m_oLigneCache.m_oLigneHTML,delete n.m_oLigneCache.m_nColonneHTML,n.m_oLigneCache=null)},WDEtatLigne.prototype.AfficheLigne=function(n,t,i,r,u){i.vPreMAJLigne(r,u);var f=this.m_tabLignesLogiques[n];f.m_oLigneCache!=t&&(this.DetacheO(f),t.DetacheEtVide(i),f.m_oLigneCache=t,t.m_oLigneHTML=this,t.m_nColonneHTML=n),f.m_oLigneLogique.style.visibility="inherit",this.vAfficheLigne(i)},WDEtatLigne.prototype.MasqueLigne=function(n,t,i,r,u){t.vPreMAJLigne(i,r);var f=this.m_tabLignesLogiques[n];this.DetacheO(f),t.vVideCellule(this,n),n==0&&t.VideRuptures(this),t.vbZR()?f.m_oLigneLogique.style.visibility="hidden":undefined!==u&&this.SetStyle(t,n,u),clWDUtil.bBaliseEstTag(f.m_oLigneLogique.parentNode,"td")&&(f.m_oLigneLogique.parentNode.style.backgroundColor="transparent"),clWDUtil.bBaliseEstTag(f.m_oLigneLogique,"tr")&&(f.m_oLigneLogique.style.backgroundColor=""),this.vAfficheLigne(t)},WDEtatLigne.prototype.vAfficheLigne=function(n){n.vbZR()?(this.m_oLignePhysique.style.visibility=this.m_tabLignesLogiques[0].m_oLigneCache?"inherit":"hidden",n.bGetSansLimite()&&1<n.vnGetNbLignesLogiquesParLignePhysique()&&0<n.nGetNbRuptures()&&clWDUtil.SetDisplay(this.m_oLignePhysique,undefined!=this.m_tabLignesLogiques[0].m_oLigneCache)):this.m_oLignePhysique.style.visibility=""},WDEtatLigne.prototype.oGetCelluleHTML=function(n,t){var i=this.m_tabCacheCelluleHTML[t];return i?i:(i=n.oGetIDElement(this.m_nLigneHTML,t),this.m_tabCacheCelluleHTML[t]=i,i)},WDEtatLigne.prototype.tabGetCelluleHTMLCache=function(){return this.m_tabCacheCelluleHTML},WDEtatLignes.prototype.RecalculeObjetsRuptures=function(n){for(var i=this.m_tabEtatLignes.length,t=0;t<i;t++)this.m_tabEtatLignes[t].RecalculeObjetsRuptures(n,t)},WDEtatLignes.prototype.Invalide=function(n,t,i,r,u){for(var e=this.m_tabEtatLignes.length,f=i;f<e;f++)t=this.m_tabEtatLignes[f].nInvalide(n,t,r,u)},WDEtatLignes.prototype.nGetNbEtatLignes=function(){return this.m_tabEtatLignes.length},WDEtatLignes.prototype.oGetEtatLigne=function(n){return this.m_tabEtatLignes[n]},WDEtatLignes.prototype.oGetCelluleHTML=function(n,t,i){var r=this.oGetEtatLigne(t);return r?r.oGetCelluleHTML(n,i):null},WDTable.prototype=new WDChamp,WDTable.prototype.constructor=WDTable,WDTable.prototype.m_nFacteurAscenseur=1,WDTable.prototype.m_nLimiteHauteur=bIE?nIE>=8?1342177:134217727:71582788,WDTable.prototype.m_bRequeteDiffereeForce=!1,WDTable.prototype.m_nColonneTrie=-1,WDTable.prototype.m_nColonneTriePre=-1,WDTable.prototype.m_bTriCroissant=!0,WDTable.prototype.m_bTriCroissantPre=!0,WDTable.prototype.m_bFinTrouve=!1,WDTable.prototype.m_sCleParcourtAP="",WDTable.prototype.m_bRetourServeurSelection=!0,WDTable.prototype.m_bMasqueVisible=!1,WDTable.prototype.m_bHauteurLigneVariable=!0,WDTable.prototype.m_nNbRuptures=0,WDTable.prototype.ms_oNotifications=new clWDUtil.WDNotifications,WDTable.prototype.ms_oNotificationsSansLimites=new clWDUtil.WDNotifications,WDTable.prototype.ms_nCachePartiel=0,WDTable.prototype.ms_nCacheComplet=1,WDTable.prototype.ms_nCacheCompletAscenseur=2,WDTable.prototype.XML_NOMBRE="NOMBRE",WDTable.prototype.XML_FIN="FIN",WDTable.prototype.XML_DEBUT="DEBUT",WDTable.prototype.XML_CLEENREGAP="CLEENREGAP",WDTable.prototype.XML_SELECTIONS="SELECTIONS",WDTable.prototype.XML_COLONNES="COLONNES",WDTable.prototype.XML_LIGNES="LIGNES",WDTable.prototype.XML_SELECTION="SELECTION",WDTable.prototype.XML_COLONNE="COLONNE",WDTable.prototype.XML_ERREUR="ERREUR",WDTable.prototype.XML_TRI="TRI",WDTable.prototype.XML_SENS="SENS",WDTable.prototype.XML_DESACTIVESERSEL="DESACTIVESERSEL",WDTable.prototype.XML_DATA="DATA",WDTable.prototype.XML_HAUTEURLIGNEVARIABLE="HAUTEURLIGNEVARIABLE",WDTable.prototype.XML_COLHIERARCHIQUE="COLHIERARCHIQUE",WDTable.prototype.ID_SCROLLBAR="SB",WDTable.prototype.ID_TABLEINTERNE="TB",WDTable.prototype.ID_CHARGEMENT_IMG="LOAD",WDTable.prototype.ID_MASQUE="MASQUE",WDTable.prototype.ID_MASQUETRANSPARENT="MASQUETR",WDTable.prototype.ID_RUPTURE_HAUT="H",WDTable.prototype.ID_RUPTURE_BAS="B",WDTable.prototype.SEL_SEPARATEUR=";",WDTable.prototype.vCacheLigne=WDTableCacheLigne,WDTable.prototype.Init=function(n,t){var e,r,u,f,o,c,s,h,l,i;WDChamp.prototype.Init.apply(this,[]),this.__CreeStyleLigneSelectionne(),this.m_oMasque=this.oGetIDElement(this.ID_MASQUE),this.m_oMasqueTransparent=this.oGetIDElement(this.ID_MASQUETRANSPARENT),this.m_oHote=this.oGetIDElement(this.ID_TABLEINTERNE);switch(this.m_eCacheLimite){case this.ms_nCachePartiel:this.m_oDivPos=this.oGetIDElement(clWDTableDefs.ID_POSITION_PIXEL),this.m_oDivPosParent=this.m_oDivPos.parentNode;break;case this.ms_nCacheCompletAscenseur:this.m_oDivPosParent=this.m_oHote.parentNode;break;case this.ms_nCacheComplet:this.m_oDivPosParent=this.m_oHote.parentNode}this.bGetSansLimiteStrict()||(e=this.m_oDivPosParent.style.height,""!=e&&-1==e.indexOf("%")&&(this.m_bSansAncrageHauteur=!0)),r=this,u=this.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_POSITION_PIXEL),u&&(this.m_oTitrePosPixel=u,this.m_oDivPosParent.onscroll=function(){u.parentNode.scrollLeft=r.m_oDivPosParent.scrollLeft}),this.m_fOnRedimImage=function(){r._OnRedimImage(this)},this.bGetSansLimite()||(this.m_fScroll=function(n){r.DeplaceTable(n||event)},this.m_oAscenseur=this.oGetIDElement(this.ID_SCROLLBAR),this.m_oAscenseurParent=this.m_oAscenseur.parentNode,this.InitForceDefilement(this.m_oDivPosParent)),this._vInitHTMLLigne(),this.AfficheMasques(),f=this.oGetElementByName(document,"_DEB"),o=0,f&&(s=this.nGetDebut(f.value),isNaN(s)||(o=s-1,h=this.sGetDebutCle(f.value),h&&(c=h))),clWDAJAXMain.m_bPageAWP&&this.m_oChampFormulaire&&(l=this.m_oChampFormulaire.value,i=document.createElement("input"),i.type="hidden",i.name=this.m_oChampFormulaire.name+"_SEL",i.id=i.name,this.m_oChampFormulaireSelAWP=this.m_oChampFormulaire.parentNode.appendChild(i)),this.Reinit(n,o,l,c,t)},WDTable.prototype._vInitInitiale=function(){WDChamp.prototype._vInitInitiale.apply(this,arguments),bIEQuirks9Max&&this.s_AddNotification(clWDUtil.s_ForceReflowDialogueParent,!1),WDTable.prototype._vInitInitiale=clWDUtil.m_pfVide},WDTable.prototype.s_AddNotification=function(n,t){(t?WDTable.prototype.ms_oNotificationsSansLimites:WDTable.prototype.ms_oNotifications).AddNotification(n)},WDTable.prototype.bGetSansLimite=function(){switch(this.m_eCacheLimite){case this.ms_nCacheComplet:case this.ms_nCacheCompletAscenseur:return!0;default:return!1}},WDTable.prototype.bGetSansLimiteStrict=function(){return this.m_eCacheLimite==this.ms_nCacheComplet},WDTable.prototype.bGetCacheCompletAscenseur=function(){return this.m_eCacheLimite==this.ms_nCacheCompletAscenseur},WDTable.prototype.bAscenseurPossible=function(){switch(this.m_eCacheLimite){case this.ms_nCachePartiel:case this.ms_nCacheCompletAscenseur:return!0;default:return!1}},WDTable.prototype.__CreeStyleLigneSelectionne=function(){if(0<this.m_tabStyle[2].length){for(var i=clWDUtil.sGetCSSTexte("."+this.m_tabStyle[2]),r="background-",u="color",t=i.split(";"),f=t.length,n=0;n<f;n++)r==clWDUtil.sSupprimeEspaces(t[n]).substr(0,r.length).toLowerCase()&&(u==clWDUtil.sSupprimeEspaces(t[n].split(":")[0]).substr(r.length,u.length).toLowerCase()&&(this.m_sCSSTexteStyleSelectionCouleurFond=clWDUtil.sSupprimeEspaces(t[n].split(":")[1])),t.splice(n,1),n--,f--);i=t.join(";"),0<i.length&&(this.m_sCSSTexteStyleSelection=i,this.m_tabCSSTexteCelluleSelection=[])}},WDTable.prototype.nGetDebut=function(n){return parseInt(n,10)},WDTable.prototype.sGetDebutCle=function(n){return(n=n+"",n.indexOf(";")>-1)?n.substring(n.indexOf(";")+1):null},WDTable.prototype._vInitHTMLLigne=function(){this.m_oSourceHTML=clWDUtil.oEvalJSON(clWDUtil.sGetHTMLDansCommentaire(this.m_oHote))},WDTable.prototype.Reinit=function(n,t,i,r,u){if(!(++this.m_nNbInits>16)){if(n===undefined||(this.m_nColonneTrie=n,this.m_nColonneTriePre=n),this.SetDebut(0),this.m_nNbLignes=0,this.m_oAffichageColonnes&&this.m_oAffichageColonnes.LibereTitres(),this.m_tabFleches&&(this.m_oAffichageColonnes=new WDAffichageColonnes(this,this.m_tabFleches,this.m_oStyleCacheLargeur),this.m_oCelluleSaisie=new WDCelluleAJAXSaisie(this)),this.m_tabSelection=[],this.m_tabColonnes=[],this.m_nNbLignesPage=this.bGetSansLimite()?0:-1,this.m_oCache=new WDTableCache(this,this.vCacheLigne),i){for(var f=parseInt(i,10);!isNaN(f);){if(this.m_tabSelection.push(f),i.indexOf(this.SEL_SEPARATEUR)==-1)break;i=i.substring(i.indexOf(this.SEL_SEPARATEUR)+1),f=parseInt(i,10)}this._vSetValeurChampFormulaire(isNaN(f)?"":f)}this.OnResizeTable(!0,t,r,u)}},bTouch){function WDDragTable(n,t){arguments.length&&(WDDrag.prototype.constructor.apply(this,[0,100]),this.m_oChampTable=n,this.m_oCible=t,this._AttacheDetacheMouseDown(!0,t,this.m_fMouseDown))}WDDragTable.prototype=new WDDrag,WDDragTable.prototype.constructor=WDDragTable,WDDragTable.prototype._vbOnMouseDown=function(){return this.m_nPositionHorizontale=this.m_oCible.scrollLeft,WDDrag.prototype._vbOnMouseDown.apply(this,arguments)},WDDragTable.prototype._vOnMouseMove=function(n){WDDrag.prototype._vOnMouseMove.apply(this,arguments),this.m_oChampTable.__bForceDefilement(-this.nGetOffsetPosY(n),n),this.m_nPosY=this._nGetPosYEvent(n),this.m_oChampTable.m_bDebordeLargeur&&(this.m_oCible.scrollLeft=Math.max(0,this.m_nPositionHorizontale-this.nGetOffsetPosX(n)))},WDTable.prototype.InitForceDefilement=function(n){new WDDragTable(this,n)}}else WDTable.prototype.OnForceDefilement=function(n){var t;return t=n.wheelDelta?-n.wheelDelta/180*this.m_nHauteurLigne:(n.detail?n.detail:0)*20,this.__bForceDefilement(t,n)},WDTable.prototype.InitForceDefilement=function(n){var t=this,i=function(n){return t.OnForceDefilement(n||event)};clWDUtil.AttacheDetacheEvent(!0,n,bFF?"DOMMouseScroll":"mousewheel",i,!1)};WDTable.prototype.__bForceDefilement=function(n,t){return 0!=this.m_nNbLignes&&0!=n&&(n=this.__nForceDefilement(n,t,!0),n!=0)?clWDUtil.bStopPropagationCond(t,n!=0):!0},WDTable.prototype.__nForceDefilement=function(n,t,i){var f=parseInt(this.m_oAscenseur.style.height,10),r,u;return f<=this.m_oAscenseurParent.clientHeight?0:(r=this.m_oAscenseurParent.scrollTop,u=r+n<0?0:r+n>f-this.m_oAscenseurParent.clientHeight?f-this.m_oAscenseurParent.clientHeight:r+n,i&&u!=r&&this._vForceDefilement(t),this.m_oAscenseurParent.scrollTop=u,this.DeplaceTable(t),this.m_oAscenseurParent.scrollTop-r)},WDTable.prototype._vForceDefilement=clWDUtil.m_pfVide,WDTable.prototype.bMAJNbLignesVisibles=function(n,t,i){if(this._vMAJDebordeLargeur(),this.bGetSansLimite())return!1;this.RedimAscenseur();var r=this.bCalculeLigneAffiche(t)||i;return t?r:(r&&(this.__GenereLignesHTML(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes(),this.m_oCache.RecalculeMarges(this)),this.MAJAscenseur(),n&&r&&this.MAJLignes(),r)},WDTable.prototype.OnResizeTable=function(n,t,i,r){this.__MAJDivPosParentHauteur(!n),this.__OnResizeTable(n,t,i,r)},WDTable.prototype.__OnResizeTable=function(n,t,i,r){var o,f,u,e;this.bMAJNbLignesVisibles(!1,!1),!this.m_bDebordeLargeur&&this.m_oAffichageColonnes&&this.m_oAffichageColonnes.ColonnesRestaure(),o=!1,t&&t>1&&(this.SetDebut(t,i),this.m_nNbLignes=t+this.m_nNbLignesPage,this.bGetSansLimite()||(this.MAJAscenseur(!0),o=!0)),r&&(u=this._oParseToXML(r),u&&u.firstChild&&(u.firstChild.tagName==clWDAJAXMain.XML_LISTE?f=u.firstChild:u.firstChild.nextSibling&&u.firstChild.nextSibling.tagName==clWDAJAXMain.XML_LISTE&&(f=u.firstChild.nextSibling))),f?e=!this.bActionListe(f,o):this.bGetSansLimite()||(this.m_oCache.bRemplitCache(this,n,-1,this.m_bTriCroissant)?e=!0:this.MAJLignes()),e&&this.AfficheMasque(e,!1)},WDTable.prototype._oParseToXML=function(n){var i,t;return window.DOMParser?(new DOMParser).parseFromString(n,"text/xml"):window.ActiveXObject?(i=new ActiveXObject("MSXML.DomDocument"),i.async=!1,i.loadXML(n),i):window.XMLHttpRequest?(t=new XMLHttpRequest,t.open("GET","data:application/xml;charset=utf-8,"+encodeURIComponent(n),!1),t.overrideMimeType("application/xml"),t.send(null),t):undefined},WDTable.prototype.OnDisplay=function(n,t){WDChamp.prototype.OnDisplay.apply(this,arguments),t&&this.m_oDivPosParent&&bEstFils(this.m_oDivPosParent,n,document)&&(this.OnResizeTable(),this.bGetSansLimite()||this.MAJAscenseurRuptures(!0))},WDTable.prototype._vOnResize=function(){(WDChamp.prototype._vOnResize.apply(this,arguments),this.m_bRedimensionneUnMasque)||(this.m_bMasqueVisible&&(this.__RedimensionneUnMasque(this.m_oMasque),this.__RedimensionneUnMasque(this.m_oMasqueTransparent)),this.OnResizeTable())},WDTable.prototype.__MAJDivPosParentHauteur=function(n){if(!this.m_bSansAncrageHauteur&&this.bAscenseurPossible()){var t;n&&bIEAvec11&&bHTML5&&(t=this.m_oDivPosParent.scrollTop),this.m_oDivPosParent.style.height="1px",bIEAvec11&&bHTML5?(clWDUtil.SetDisplay(this.m_oDivPosParent,!1),!this.m_nMAJDivPosParentHauteurScrollTop&&t&&(this.m_nMAJDivPosParentHauteurScrollTop=t),this.nSetTimeoutUnique("__MAJDivPosParentHauteur2",clWDUtil.ms_nTimeoutNonImmediat100)):this.__MAJDivPosParentHauteur2(0)}},WDTable.prototype.__MAJDivPosParentHauteur2=function(){var n=this.__nCorrigeHauteurIEAncrage(function(n){return n.offsetHeight},this.m_oDivPosParent.parentNode,this.m_oDivPosParent.parentNode.parentNode.parentNode.parentNode.parentNode);bIEAvec11&&bHTML5&&clWDUtil.SetDisplay(this.m_oDivPosParent,!0),(bFF||bIEAvec11&&bHTML5)&&(n-=this.s_nGetOffsetBorderPourWidth(clWDUtil.oGetCurrentStyle(this.m_oDivPosParent.parentNode))),this.m_oDivPosParent.style.height=0<n?n+"px":"0",bIEAvec11&&bHTML5&&this.__OnResizeTable(),this.m_nMAJDivPosParentHauteurScrollTop&&(this.m_oDivPosParent.scrollTop=this.m_nMAJDivPosParentHauteurScrollTop),delete this.m_nMAJDivPosParentHauteurScrollTop},WDTable.prototype.__nCorrigeHauteurIEAncrage=function(n,t,i){var r=n(t);return bIEAvec11&&r<4&&(r=Math.max(r,n(i))),r},WDTable.prototype.InitEtatLignes=function(n){this.m_oEtatLignes=new WDEtatLignes(this,n)},WDTable.prototype.__nNbLignesPage=function(n){var t=this.__nCorrigeHauteurIEAncrage(function(n){return Math.min(n.clientHeight,n.scrollHeight)},this.m_oDivPosParent.parentNode,this.m_oDivPosParent.parentNode.parentNode.parentNode.parentNode.parentNode);return this.m_bDebordeLargeur&&(t-=18),Math.max(Math.floor(t/n*this.vnGetNbLignesLogiquesParLignePhysique()),1)},WDTable.prototype.bCalculeLigneAffiche=function(n){var t=this.__nNbLignesPage(this.m_nHauteurLigne);return t!=this.m_nNbLignesPage?(n||(this.m_nNbLignesPage=t),!0):!1},WDTable.prototype._vRefresh=function(n,t,i,r,u,f){WDChamp.prototype._vRefresh.apply(this,arguments);var e=!1;switch(n){case 1:this.SetDebut(0),this.bGetSansLimite()||(e=!0);case 2:t>-1&&(this.SetDebut(t,i),e=!0)}undefined!==u&&u!=this.m_nNbLignes&&(this.m_nNbLignes=u,e=!0),undefined!==r&&(this.oGetElementByName(document,"_DATA").value=r),this.__RemplitSelonXML(f),e&&!this.bGetSansLimite()&&this.MAJAscenseur(!0),this.m_oCache.bRemplitCache(this,!0,this.m_nColonneTrie,this.m_bTriCroissant),this.m_oEtatLignes.Invalide(this,this.m_nDebut,0,!1,null),this.AfficheMasque(!0,!0)},WDTable.prototype.SetDebut=function(n,t){var i,r;this.bGetSansLimite()&&0!=n||(this.m_nDebut=n,i=this.oGetElementByName(document,"_DEB"),i&&(i.value=n),!t&&this.m_oCache&&(r=this.m_oCache.oGetLigne(n),r&&(t=r.sGetCleEnreg(),t.length==0&&(t=null))),t?(this.m_sCleDebut=t,i&&(i.value+=";"+t)):delete this.m_sCleDebut)},WDTable.prototype.RequeteSelection=function(n){var t=this._vsGetValeurChampFormulaire();this._vSetValeurChampFormulaire(this.sConstruitRequeteSelection()),this.m_oCache.CreeRequeteSelection(this,n),this._vSetValeurChampFormulaire(t),this.AfficheMasque(!0,!0)},WDTable.prototype.vnGetNbLignesLogiquesParLignePhysique=function(){return 1},WDTable.prototype._vSetValeurChampFormulaire=function(){WDChamp.prototype._vSetValeurChampFormulaire.apply(this,arguments),this.m_oChampFormulaireSelAWP&&(this.m_oChampFormulaireSelAWP.value=this.sConstruitRequeteSelection())},WDTable.prototype.nLigneSelectionne=function(n){return this.nLigneSelectionnePosAbsolue(this.nPosVisible2PosAbsolue(n))},WDTable.prototype.nLigneSelectionnePosAbsolue=function(n){return clWDUtil.nDansTableau(this.m_tabSelection,n)},WDTable.prototype.bLigneEstSelectionnee=function(n){return clWDUtil.nElementInconnu!=this.nLigneSelectionne(n)},WDTable.prototype.vbLigneEstSelectionneeSansZR=WDTable.prototype.bLigneEstSelectionnee,WDTable.prototype.__bLigneSelectionne=function(n,t,i){return this._bLigneSelectionnePosAbsolue(this.nPosVisible2PosAbsolue(n),n,t,i)},WDTable.prototype.bLigneSelectionnePosAbsolue=function(n,t,i,r){return clWDUtil.nElementInconnu!=this.nLigneSelectionnePosAbsolue(n)?!1:this._bLigneSelectionnePosAbsolue(n,t,i,r)},WDTable.prototype._bLigneSelectionnePosAbsolue=function(n,t,i,r){if(this.m_tabSelection.push(n),this.__bLigneEstVisible(t)){var u=this.m_oCache.oGetLigne(t);u&&u.SetStyle(this.m_tabStyle[2],this,t,r,!0)}return this._vSetValeurChampFormulaire(n+1),i&&this.RecuperePCode(this.ms_nEventNavSelectLigne)(r),!0},WDTable.prototype.bLigneDeselectionne=function(n,t){var i=this.m_tabSelection,f,r,u;return n<0||n>=i.length?!1:(f=i[n],r=this.nPosAbsolue2PosVisible(f),i.splice(n,1),this.__bLigneEstVisible(r)&&(u=this.m_oCache.oGetLigne(r),u&&u.SetStyle(this.m_tabStyle[r%2==0?0:1],this,r,t,!1)),this._vSetValeurChampFormulaire(i.length>0?i[i.length-1]+1:""),!0)},WDTable.prototype.bLigneDeselectionneTous=function(n,t){for(var r=!1,u=this.m_tabSelection,i=0;u.length>i;)n!=u[i]?r=this.bLigneDeselectionne(i,t):i++;return r},WDTable.prototype.sConstruitRequeteSelection=function(){return this.m_tabSelection.join(this.SEL_SEPARATEUR)},WDTable.prototype.__bLigneEstVisible=function(n){return this.bGetSansLimite()?n<this.m_nNbLignes:n>=this.m_nDebut&&n<=this.m_nDebut+this.m_nNbLignesPage+1},WDTable.prototype.bActionListeDepuisAJAX=function(n,t){this.bActionListe(n)&&t>-1&&this.__bLigneEstVisible(t)&&this.MAJLigne(t)},WDTable.prototype.bActionListe=function(n,t){var a=this.m_nNbLignes,e,c,i,u,o,s,r,f,l,h;this.m_nNbLignes=parseInt(clWDAJAXMain.sXMLGetAttribut(n,this.XML_NOMBRE),10),e=document.getElementsByName("_"+this.sGetNomElement("_OCC"))[0],e&&(e.value=this.m_nNbLignes),clWDAJAXMain.bXMLAttributExiste(n,this.XML_DESACTIVESERSEL)&&(this.m_bRetourServeurSelection=!1),clWDAJAXMain.bXMLAttributExiste(n,this.XML_DATA)&&(document.getElementsByName(this.sGetNomElement("_DATA"))[0].value=clWDAJAXMain.sXMLGetAttribut(n,this.XML_DATA)),this.m_bHauteurLigneVariable=clWDAJAXMain.bXMLGetAttributSafe_Vrai(n,this.XML_HAUTEURLIGNEVARIABLE),this._vActionListeSpecifique(n),c=this.m_nNbRuptures,this.m_nNbRuptures=clWDAJAXMain.nXMLGetAttributSafe(n,clWDAJAXMain.XML_CHAMP_LIGNES_RUPTURES,0),this.bGetSansLimite()&&(a==this.m_nNbLignes&&(this.vbZR()||this.bGetCacheCompletAscenseur())?this.m_nNbLignes==0&&this.InitEtatLignes(0):(this.__GenereLignesHTML(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes())),this.m_nNbRuptures!=c&&this.m_oEtatLignes.RecalculeObjetsRuptures(this),clWDAJAXMain.bXMLAttributExiste(n,this.XML_TRI)?(this.m_nColonneTriePre=clWDAJAXMain.nXMLGetAttribut(n,this.XML_TRI),this.m_bTriCroissantPre=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_SENS),this.__TriColonne(this.m_nColonneTriePre,this.m_bTriCroissantPre)):(delete this.m_nColonneTriePre,delete this.m_bTriCroissantPre),this.m_bFinTrouve=clWDAJAXMain.bXMLGetAttributSafe(n,this.XML_FIN),this.m_sCleParcourtAP=clWDAJAXMain.sXMLGetAttributSafe(n,this.XML_CLEENREGAP,""),i=clWDAJAXMain.bXMLAttributExiste(n,this.XML_DEBUT),i&&(s=clWDAJAXMain.sXMLGetAttribut(n,this.XML_DEBUT),u=this.nGetDebut(s),o=this.sGetDebutCle(s));switch(clWDAJAXMain.nXMLGetAttributSafe(n,clWDAJAXMain.XML_CHAMP_REFRESH_RESETTABLE,0)){case 1:return i?this._vRefresh(1,u,o):this._vRefresh(1,-1),!1;case 2:return this._vRefresh(2,-1),!1;default:i&&this.SetDebut(u,o)}if(this.m_oCache.SupprimeLignesInutiles(this),this.__RemplitSelonXML(n.firstChild),r=this.m_tabColonnes,this.m_oPopupSaisieTRF&&this.m_oPopupSaisieTRF.AjouteLienImages(r),this.m_oAffichageColonnes)for(this.m_oAffichageColonnes.Init(r),l=r.length,f=0;f<l;f++)if(h=r[f],h.m_nRangCreation!=h.m_nPositionAffichage){this.m_oAffichageColonnes.LibereTitres(),this.__GenereLignesHTML(!0),this.m_oAffichageColonnes.InitTitres(),this.InitEtatLignes(this.m_nNbLignesHTML),this.AfficheColonnes();break}return this.bGetSansLimite()||(t|=i,(t||!this.bGetHauteurLigneVariable())&&this.MAJAscenseur(t)),this.MAJLignes(),!this.bGetSansLimite()&&this.bGetHauteurLigneVariable()&&this.MAJAscenseurRuptures(),this.bGetSansLimite()&&i&&(location.hash="#"+this.sGetNomElement(this.sGetSuffixeIDElement(u))),this.m_bFinTrouve==!1&&this.ChercheFin(),0==this.m_oCache.m_tabRequetes.length&&this.m_oCelluleSaisie&&this.m_oCelluleSaisie.OnMAJDonnees(),!0},WDTable.prototype.__RemplitSelonXML=function(n){while(n!=null){switch(n.nodeName){case this.XML_LIGNES:this.m_oCache.RemplitCacheLignes(this,n);break;case this.XML_SELECTIONS:this.RemplitSelection(n);break;case this.XML_COLONNES:this.RemplitColonnes(n);break;case this.XML_ERREUR:this.AfficheErreur(n)}n=n.nextSibling}},WDTable.prototype._vActionListeSpecifique=clWDUtil.m_pfVide,WDTable.prototype.bGetHauteurLigneVariable=function(){return this.m_bHauteurLigneVariable||this.m_nNbRuptures>0},WDTable.prototype._vsGetCSSLigneHeight=function(){return"height"},WDTable.prototype.__GenereLignesHTML=function(n){this.m_nNbLignesHTML=this.bGetSansLimite()?0<this.nGetNbRuptures()?this.m_nNbLignes:Math.ceil(this.m_nNbLignes/this.vnGetNbLignesLogiquesParLignePhysique()):Math.ceil(this.m_nNbLignesPage/this.vnGetNbLignesLogiquesParLignePhysique()+2);var t=this._vtabGenereLignesHTML(n);this.__PlaceDansTable(this.m_oHote,t),bIE&&(this.m_oHote=this.oGetIDElement(this.ID_TABLEINTERNE))},WDTable.prototype._vtabGenereLignesHTML=function(n){var e=this.m_oSourceHTML,h=e.tbody,c=new RegExp("\\[%"+this.m_sAliasChamp+"%\\]","g"),t=this.__sConstruitHTML(h.contenu[0]),u,f,i;for(t=t.replace(c,"[%_INDICE_%]"),t=t.replace(/\[%_INDICE_;1%\]/g,"[%_INDICE_%]"),t=t.replace(/\[%_CSS_HEIGHT_%\]/g,this._vsGetCSSLigneHeight),u=this.m_nNbLignesHTML,f=new Array(u),i=0;i<u;i++)f[i]=t.replace(/\[%_INDICE_%\]/g,i);if(n&&this.m_oTitrePosPixel){for(var l=e.thead,o=[],s=l.contenu,a=s.length,r=0;r<a;r++)o.push(this.__sConstruitHTML(s[r]));this.__PlaceDansTable(this.m_oTitrePosPixel,o),bIE&&(this.m_oTitrePosPixel=this.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_POSITION_PIXEL))}return f},WDTable.prototype.__sConstruitHTML=function(n){var t=[],i,f,r,o,e,u,s;if(t.push(n.debut),i=n.contenu,this.m_oAffichageColonnes&&this.m_oAffichageColonnes.m_tabPositionAffichage.length)for(f=this.m_oAffichageColonnes.m_tabPositionAffichage,o=f.length,r=0;r<o;r++)e=f[r].m_oColonne,e.m_bVisible&&t.push(i[e.m_nRangCreation]);else for(s=i.length,u=0;u<s;u++)t.push(i[u]);return t.push(n.fin),t.join("")},WDTable.prototype.__PlaceDansTable=function(n,t){var i,r;SupprimeFils(n),bIE?(i=n.outerHTML,i=clWDAJAXMain.sSansEspace(i,!0,!0,!0),n.outerHTML=i.substr(0,i.length-"<\/TABLE>".length)+t.join("")+"<\/TABLE>"):(r=document.createRange(),r.setStart(n,0),n.appendChild(r.createContextualFragment(t.join(""))),n.style.width=n.style.width)},WDTable.prototype.RemplitSelection=function(n){var t,i;for(this.bLigneDeselectionneTous(-1),t=n.firstChild;t!=null;)i=clWDAJAXMain.nXMLGetValeur(t),this.bLigneSelectionnePosAbsolue(i,this.nPosAbsolue2PosVisible(i),!1),t=t.nextSibling},WDTable.prototype.nGetNbRuptures=function(){return this.m_nNbRuptures},WDTable.prototype.RemplitColonnes=function(n){for(var i=[],t=n.firstChild;t!=null;)i.push(new WDTableAJAXColonne(t,i.length)),t=t.nextSibling;this.m_tabColonnes=i,this.AfficheColonnes()},WDTable.prototype.AfficheColonnes=function(){var i,r,n,u,t;for(this.m_oStyleCacheLargeur.CreationAjout(),i=!0,this.bGetCacheCompletAscenseur()&&(this.m_oAffichageColonnes.__ColonnesFige_StyleEnCreation(),i=!1),r=this.m_tabColonnes,u=r.length,n=0;n<u;n++)t=r[n],this.AfficheColonne(n,t.m_bVisible),0<t.m_nLargeur&&this.m_oAffichageColonnes&&(i&&(this.m_oAffichageColonnes.__ColonnesFige_StyleEnCreation(),i=!1),this.m_oAffichageColonnes.__SetDimColonne(t,t.m_nLargeur));this.m_oStyleCacheLargeur.CreationFin()},WDTable.prototype.nGetNbNiveauAutourCellule=function(n){return clWDUtil.bBaliseEstTag(n.parentNode,"td")&&n.parentNode.style.cssText!=""?6:2},WDTable.prototype.AfficheColonne=function(n,t){var i,r,e;if(this.AfficheCellule(clWDTableDefs.ID_TITRE,n,2,t),i=this.oGetIDElement(0,n),i){var u=this.nGetNbNiveauAutourCellule(i),f=this.__oGetParent(i,u),o=clWDUtil.oGetCurrentStyle(f);if(o.display!=clWDUtil.sGetDisplayPourAffiche(f,t))for(e=this.m_oEtatLignes.nGetNbEtatLignes(),r=0;r<e;r++)this.AfficheCellule(r,n,u,t)}},WDTable.prototype.AfficheCellule=function(n,t,i,r){var f=this.oGetIDElement(n,t),u;if(f=this.__oGetParent(f,i),f){for(clWDUtil.SetDisplay(f,r),u=f.nextSibling;u&&u.nodeName=="#text";)u=u.nextSibling;u&&u.id.length==0&&clWDUtil.SetDisplay(u,r)}},WDTable.prototype.__oGetParent=function(n,t){while(n&&t-->0)n=n.parentNode;return n},WDTable.prototype.AfficheErreur=function(n){alert(clWDAJAXMain.sXMLGetValeur(n))},WDTable.prototype.vVideCellule=function(n){var i=n.tabGetCelluleHTMLCache(),t,r;for(r in i)i.hasOwnProperty(r)&&(t=i[r],t&&(SupprimeFils(t),t=t.parentNode,!this.vbZR()&&this.bGetHauteurLigneVariable()&&(t=t.parentNode),this.vnGetNbLignesLogiquesParLignePhysique()>1&&(t=t.firstChild),t.style.backgroundColor=""))},WDTable.prototype.vRemplitCellule=function(n,t,i,r,u,f){var e,c=this,l,o,a,v,y,h,p,s;this.m_tabColonnes[r].m_sBulle?n.title=this.m_tabColonnes[r].m_sBulle:n.removeAttribute("TITLE",0),l=!1;switch(this.eColonneTypeIDObjet(r)){case this.ms_nIDObjetInterrupteur:if(!1==this.m_tabColonnes[r].m_bVisible)break;e=document.createElement("input"),e.type="checkbox",l=t=="1",v=this.sGetSuffixeIDElement(i,this.m_sAliasChamp,r),e.name=v,e.id=v,this.bColonneSaisissable(r)?e.onclick=function(n){return c.ClickInterrupteur(n||event,e,i,r),clWDUtil.bStopPropagation(n)}:e.disabled=!0,n.style.textAlign="center",n.style.verticalAlign="middle";break;case this.ms_nIDObjetImage:t.length>0&&(e=document.createElement("img"),bIE?e.onreadystatechange=this.m_fOnRedimImage:e.onload=this.m_fOnRedimImage,e.src=t,this.nColonneLien(r)>0&&(this.nColonneEtatLien(r)==0||this.nColonneEtatLien(r)==5)&&(e.onclick=function(n){c.OnColonneLien(i,r,n||event)}),n.style.textAlign="center",n.style.verticalAlign="middle");break;case this.ms_nIDObjetCombo:case this.ms_nIDObjetSaisie:default:switch(this.nColonneLien(r)){default:case 0:if(this.m_bHauteurLigneVariable&&(-1!=t.indexOf("\r")||-1!=t.indexOf("\n")))for(e=document.createElement("span"),y=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n"),a=y.length,o=0;o<a;o++)o>0&&e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode(y[o]));else e=document.createTextNode(t);break;case 1:case 2:e=document.createElement("a");switch(this.nColonneEtatLien(r)){default:case 0:case 5:e.href="javascript:void(0);",e.onclick=function(n){c.OnColonneLien(i,r,n||event)};break;case 4:e.disabled=!0;case 1:e.readOnly=!0}e.innerHTML=clWDUtil.sEncodeInnerHTML(t,!0)}}for(h=n.getElementsByTagName("a"),a=h.length,o=0;o<h;o++)h[o].onclick=null;SupprimeFils(n),e&&(p=n.appendChild(e),l&&(e.checked=!0)),undefined!==this.m_sCSSTexteStyleSelection&&(s=this.m_tabCSSTexteCelluleSelection[n.id],f?(undefined===s&&(s=clWDUtil.sGetCSSTexteElement(n),this.m_tabCSSTexteCelluleSelection[n.id]=s),n.style.cssText=s+this.m_sCSSTexteStyleSelection):undefined!==s&&(n.style.cssText=s,delete this.m_tabCSSTexteCelluleSelection[n.id])),p&&this.eColonneTypeIDObjet(r)==WDChamp.prototype.ms_nIDObjetImage&&(this.bGetSansLimite()||(this.m_tabImagesNonAffichee.push(p),this.nSetTimeoutUnique("_OnAscenseurRedimImage",500))),this.bColonneSaisissable(r)==!1&&(n.style.cursor="default")},WDTable.prototype.VideRuptures=function(n){this.nGetNbRuptures()>0&&(this.VideUneRupture(n.m_oRupturesHaut),this.VideUneRupture(n.m_oRupturesBas))},WDTable.prototype.VideUneRupture=function(n){n&&(SupprimeFils(n),clWDUtil.SetDisplay(n.parentNode,!1))},WDTable.prototype.RemplitRuptures=function(n,t,i){this.nGetNbRuptures()>0&&(i=i?i:{},this.RemplitUnRupture(n.m_oRupturesHaut,i.m_sHaut,t==0),this.RemplitUnRupture(n.m_oRupturesBas,i.m_sBas,!0))},WDTable.prototype.RemplitUnRupture=function(n,t,i){n&&(i&&this.VideUneRupture(n),t&&t.length&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(t,!1,!0),clWDUtil.SetDisplay(n.parentNode,!0)))},WDTable.prototype.ClickInterrupteur=function(n,t,i,r){var u=this.nAbsolue2Relative(i),f,e;if(this.bCreeLigneVirtuelle(u)){if(this.m_oCelluleSaisie.bSaisieEnCoursDansCellule(u,r)){this.m_oCelluleSaisie.SaisieFin(!0,!0,this.m_oCelluleSaisie.ms_nColonneSuivante,n),this.m_bBloqueClickSurLigne=!0;return}f=t.checked?"1":"0",e=t.checked?1:0,this.SetValeurCellule(u,r,f,e),this.ValideChangement(u),this.bMAJLigne(i),this.SupprimeLignesVirtuelles()}},WDTable.prototype.ChercheFin=function(){this.m_oCache.m_tabRequetes.length>0||this.m_bFinTrouve||this.nSetTimeoutUnique("EnvoieChercheFin",1e3)},WDTable.prototype.EnvoieChercheFin=function(){this.m_oCache.m_tabRequetes.length>0||this.m_bFinTrouve||this.m_oCache.CreeRequete(this,new Segment(-1,-1),-1,!0,-1,"")},WDTable.prototype.bMAJLigne=function(n){return this.m_oCache.bMAJLigne(this,n,this.vbLigneEstSelectionneeSansZR(n))},WDTable.prototype.bMAJLigneRel=function(n){return this.bMAJLigne(this.nRelative2Absolue(n))},WDTable.prototype.nRelative2Absolue=function(n){return n+this.m_nDebut},WDTable.prototype.nAbsolue2Relative=function(n){return n-this.m_nDebut},WDTable.prototype.MAJLignes=function(n){for(var u=0,c=this.m_oEtatLignes.nGetNbEtatLignes(),o=this.vnGetNbLignesLogiquesParLignePhysique(),i=this.m_nDebut,e,l=0,s=0,p,a,r,t,w,v,y,h,f=0;f<c;f++)for(r=this.oGetEtatLigne(f),t=0;t<o;t++,i++)if(w=r.bJamaisAffiche(t),i>=this.m_nNbLignes)(w||r.bPlein(t))&&r.MasqueLigne(t,this,i,n,i%2==0?this.m_tabStyle[0]:this.m_tabStyle[1]),u++;else{if(e=this.m_oCache.oGetLigne(i),e&&(l=e.vnGetNbReplieesOuEnroulees(),0<l&&(s+=l),p=f,a=t,e.vnGetColonneHTML()!=t)){for(;t<o;t++)r.MasqueLigne(t,this,i,n),u++;break}v=this.vbLigneEstSelectionneeSansZR(i),r.bMAJ(t,e,this,i,n,v),y=i%2==0?this.m_tabStyle[0]:this.m_tabStyle[1],(undefined!==this.m_sCSSTexteStyleSelection||undefined!=this.m_sCSSTexteStyleSelectionCouleurFond)&&v&&(y=this.m_tabStyle[2]),r.SetStyle(this,t,y),r.bPlein(t)&&u++}if(s>0&&u+s>=this.m_nNbLignes)for(f=p;f<c;f++){for(++i,t=a+1;t<o;t++)r.MasqueLigne(t,this,i,n),u++;a=-1}this._vPostMAJLignes(),h=c*o,0<s&&u!=h&&(u=h),this.AfficheMasque(u!=h,!1)},WDTable.prototype._vPostMAJLignes=function(){this.ms_oNotifications.LanceNotifications(this,this.m_oDivPosParent),clWDUtil.m_oNotificationsAjoutHTML.LanceNotifications(this,this.m_oDivPosParent),this.bGetSansLimite()&&(this.ms_oNotificationsSansLimites.LanceNotifications(this,this.m_oDivPosParent),clWDUtil.m_oNotificationsRedimensionnement.LanceNotifications(this,this.m_oDivPosParent)),window.FinSubmitAJAX&&typeof FinSubmitAJAX=="function"&&FinSubmitAJAX()},WDTable.prototype.AfficheMasque=function(n,t){(this.m_oCache.bAvecRequeteTri()&&(n=!0),this.m_bMasqueVisible!=n)&&(this.m_bMasqueVisible=n,this.AfficheMasques(t),t&&this.nSetTimeout(this.AfficheMasques,1e3,!1))},WDTable.prototype.AfficheMasques=function(n){this.AfficheUnMasque(this.m_oMasque,this.m_bMasqueVisible&&!n),this.AfficheUnMasque(this.m_oMasqueTransparent,this.m_bMasqueVisible&&n)},WDTable.prototype.AfficheUnMasque=function(n,t){n.style.left=t?n.parentNode.scrollLeft:0,this.__RedimensionneUnMasque(n),clWDUtil.SetDisplay(n,t),n.style.visibility=""},WDTable.prototype.__RedimensionneUnMasque=function(n){var i,t,r,u;try{this.m_bRedimensionneUnMasque=!0,i=clWDUtil.oGetCurrentStyle(n),t=n.parentNode,bIEQuirks?(n.style.width=Math.max(this._nGetOffsetWidth(t,i),0)+"px",n.style.height=Math.max(this._nGetOffsetHeight(t,i),0)+"px"):(n.style.height="1px",r=this._nGetOffsetHeight(t,i),this.bGetSansLimiteStrict()&&(r=Math.min(r,t.scrollHeight)),n.style.width=Math.max(this._nGetOffsetWidth(t,i),0)+"px",n.style.height=Math.max(r,0)+"px",this.bGetSansLimiteStrict()&&(u=t.style.position,t.style.position="",t.offsetHeight,t.style.position=u))}finally{this.m_bRedimensionneUnMasque=!1}},WDTable.prototype._vMasqueLigneInterne=clWDUtil.m_pfVide,WDTable.prototype.nGetAscenseurParentScrollTop=function(){var n=this.m_nAscenseurParentScrollTop?this.m_nAscenseurParentScrollTop:this.m_oAscenseurParent.scrollTop;return this.m_nFacteurAscenseur==1?n:n*this.m_nFacteurAscenseur*(1+this.m_nNbLignesPage*(this.m_nFacteurAscenseur-1)/(this.m_nNbLignes-this.m_nNbLignesPage))},WDTable.prototype.SetAscenseurParentScrollTop=function(n,t){var r=n,i,u;this.m_nFacteurAscenseur>1&&(r=n/this.m_nFacteurAscenseur,r*=1-t*(this.m_nFacteurAscenseur-1)/(this.m_nNbLignes-t)),i=Math.max(Math.floor(r),0),u=this.m_nAscenseurParentScrollTop!==undefined?this.m_nAscenseurParentScrollTop:this.m_oAscenseurParent.scrollTop,u!=i&&(this.m_nAscenseurParentScrollTop=i,this.SetAscenseurParentScrollTopCallBack(i))},WDTable.prototype.SetAscenseurParentScrollTopCallBack=function(n){delete this.m_nAscenseurParentScrollTop,this.m_oAscenseurParent.scrollTop=n},WDTable.prototype._vMAJDebordeLargeur=function(){if(bIEQuirks&&this.m_oDivPosParent.scrollWidth,this.m_bDebordeLargeur=this.m_oDivPosParent.scrollWidth>this.m_oDivPosParent.clientWidth,bIE&&this.bGetSansLimite()&&(this.m_bDebordeLargeur?this.m_oDivPosParent.style.overflowX=="auto"&&(this.m_oDivPosParent.style.overflowX="scroll",this.m_bDebordeLargeurIEForceScroll=!0):this.m_bDebordeLargeurIEForceScroll&&(this.m_bDebordeLargeurIEForceScroll=!1,this.m_oDivPosParent.style.overflowX="auto")),(this.m_oDivPosParent.style.overflowX=="scroll"||this.m_oDivPosParent.style.overflow=="scroll")&&(this.m_bDebordeLargeur=!0),this.m_oTitrePosPixel&&this.bGetCacheCompletAscenseur()){var n=this._nGetLargeurAscenseurVertical(this.m_oDivPosParent);this.m_oTitrePosPixel.parentNode.parentNode.style.paddingRight=n<=0?"":n+"px"}},WDTable.prototype.RedimAscenseur=function(){var n,t,i;if(!bIEAvec11||bHTML5||this.m_bSansAncrageHauteur?(n=this.m_oAscenseurParent.parentNode.clientHeight,bIEAvec11&&bHTML5&&0==n&&(n=this.m_oAscenseurParent.parentNode.offsetHeight,0==n&&(n=this.m_oAscenseurParent.parentNode.scrollHeight))):n=this.m_oAscenseurParent.parentNode.parentNode.parentNode.clientHeight,t=n-this._nGetHauteurAscenseurHorizontal(this.m_oDivPosParent),bIEAvec11&&bHTML5&&(t-=this.s_nGetOffsetBorderPourWidth(clWDUtil.oGetCurrentStyle(this.m_oDivPosParent.parentNode))),t<1){if(bIEAvec11&&this.m_oAscenseurParent.style.height!="")return;t=1}i=t+"px",this.m_oAscenseurParent.style.height!=i&&(this.m_oAscenseurParent.style.height=i,!bIEAvec11||bHTML5||this.m_bSansAncrageHauteur||(this.m_oAscenseurParent.parentNode.style.height=i))},WDTable.prototype.__nGetHauteurLigne=function(n){return this.m_oCache.nGetHauteur(n)},WDTable.prototype.__nGetHauteurPremiereLigne=function(){var i=this.oGetEtatLigne(0),n,t;return i&&(n=i.oGetLigneLogique(0),n&&(t=n.m_oLigneCache,t))?t.nGetHauteur():-1},WDTable.prototype.nGetDivPosTop=function(){var i=this.m_oDivPos.style.top,n,t;return i.length==0?0:(n=parseFloat(i),this.bGetHauteurLigneVariable()&&(t=this.__nGetHauteurPremiereLigne(),t!=-1&&t!=this.m_nHauteurLigne&&(n=n*this.m_nHauteurLigne/t)),parseInt(n,10))},WDTable.prototype.SetDivPosTop=function(n){var i=n,t,r;this.bGetHauteurLigneVariable()&&(t=this.__nGetHauteurPremiereLigne(),-1==t&&(this._bCalculeHauteurLigne(),t=this.__nGetHauteurPremiereLigne()),r=this.nGetLastHauteurLigneMoyenne(),t!=r&&(i=i*t/r)),this.m_oDivPos.style.top=i+"px"},WDTable.prototype._vnGetOffset=function(n){return bIEQuirks?0:this.s_nGetOffset(n.borderBottomWidth)},WDTable.prototype._OnRedimImage=function(n){var t=this.m_tabImagesNonAffichee,r,i;for(WDTableZRNavigateur.prototype.s_bRedimImage(n)&&(r=clWDUtil.bDansTableau(t,n),clWDUtil.nElementInconnu!=r&&t.splice(r,1)),i=0;i<t.length;i++)t[i].parentNode||(t.splice(i,1),i--);this.bGetSansLimite()||0!=t.length||(this.AnnuleTimeXXX("_OnAscenseurRedimImage",!1),this.m_bHauteurLigneVariable&&this.MAJAscenseurRuptures(!0,!0))},WDTable.prototype._OnAscenseurRedimImage=function(){this.m_bHauteurLigneVariable||clWDUtil.bForEach(this.m_tabImagesNonAffichee,function(n){return n.parentNode&&WDTableZRNavigateur.prototype.s_bRedimImage(n),!0}),this.m_tabImagesNonAffichee=[],this.m_bHauteurLigneVariable&&this.MAJAscenseurRuptures(!0,!0)},WDTable.prototype._bCalculeHauteurLigne=function(n,t){for(var o=!1,s=this.m_oEtatLignes.nGetNbEtatLignes(),i,f,e,r,u=0;u<s;u++)i=this.oGetEtatLigne(u),i.bPlein(0)&&(f=i.oGetLigneLogique(0).m_oLigneCache,e=f.nGetHauteur(),(-1==e||n&&0==e||t)&&(r=i.m_oLignePhysique.offsetHeight,r+=this._vnGetOffset(i.m_oLignePhysique),this.nGetNbRuptures()>0&&(i.m_oRupturesHaut&&(r+=i.m_oRupturesHaut.parentNode.offsetHeight),i.m_oRupturesBas&&(r+=i.m_oRupturesBas.parentNode.offsetHeight)),o|=f.bSetHauteur(r)));return o},WDTable.prototype.nGetLastHauteurLigneMoyenne=function(){return this.m_nLastHauteurLigneMoyenne?this.m_nLastHauteurLigneMoyenne:this.m_nHauteurLigne},WDTable.prototype.nGetLastNbLignesLogiquesParLignePhysiqueMoyen=function(){return this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen?this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen:this.vnGetNbLignesLogiquesParLignePhysique()},WDTable.prototype.nGetHauteurLigneMoyenne=function(){var r,t;if(this.bGetHauteurLigneVariable()){for(var u=0,i=0,f=this.m_oEtatLignes.nGetNbEtatLignes(),n=0;n<f;n++)r=this.oGetEtatLigne(n),r.oGetLigneLogique(0).m_oLigneCache&&(t=r.oGetLigneLogique(0).m_oLigneCache.nGetHauteur(),t&&t>0&&(u+=t,i++));if(i>0)return Math.ceil(u/i);if(this.m_nLastHauteurLigneMoyenne&&this.m_nLastHauteurLigneMoyenne>0)return this.m_nLastHauteurLigneMoyenne}return this.m_nHauteurLigne},WDTable.prototype.nGetNbLignesLogiquesParLignePhysiqueMoyen=function(){var t=this.vnGetNbLignesLogiquesParLignePhysique(),f,n,e;if(this.nGetNbRuptures()>0){for(var u=0,r=0,o=this.m_oEtatLignes.nGetNbEtatLignes(),i=0;i<o;i++)for(f=this.oGetEtatLigne(i),e=t,n=0;n<e;n++)f.bPlein(n)&&(n==0&&r++,u++);return r>0?Math.min(u/r,t):t}return t},WDTable.prototype.MAJAscenseurRuptures=function(n,t){0==this.m_tabImagesNonAffichee.length&&this._bCalculeHauteurLigne(n,t)&&this.MAJAscenseur()},WDTable.prototype.MAJAscenseur=function(n,t){var r,i,f,u,e,s,o,h,c;this._vMAJDebordeLargeur(),this.RedimAscenseur(),n&&this.SetDivPosTop(0),this.m_oDivPosParent.scrollTop="0px",r=this.nGetHauteurLigneMoyenne(),f=this.nGetNbLignesLogiquesParLignePhysiqueMoyen(),i=f>1?Math.floor(r*Math.ceil(this.m_nNbLignes/f)):Math.floor(r*this.m_nNbLignes),i<=0&&(i=1),this.m_nFacteurAscenseur=Math.ceil(i/this.m_nLimiteHauteur),this.m_nFacteurAscenseur>1&&(i=Math.floor(i/this.m_nFacteurAscenseur)),e=r==this.m_nHauteurLigne?this.m_nNbLignesPage:this.__nNbLignesPage(r),this.m_nDebut>0&&this.m_nNbLignes-this.m_nDebut<e&&(u=this.m_nNbLignes-e,u<0&&(u=0,this.SetAscenseurParentScrollTop(0,e)),this.SetDebut(u)),s=parseInt(this.m_oAscenseur.style.height,10),(s!=i||n)&&(o=this.nGetDivPosTop(),h=Math.floor((this.m_oAscenseurParent.scrollTop*this.m_nFacteurAscenseur-o)/r)!=this.m_nDebut||n,this.m_oAscenseur.style.height=i+"px",h&&(c=this.m_nDebut/f*r+o,this.SetAscenseurParentScrollTop(c,e))),this.m_nLastHauteurLigneMoyenne=r,this.m_nLastNbLignesLogiquesParLignePhysiqueMoyen=f,this.m_oAscenseurParent.onscroll||(this.m_oAscenseurParent.onscroll=this.m_fScroll),t||undefined==u||this.DeplaceTable(undefined,u)},WDTable.prototype.nGetDebutLogique=function(n){var r=n*this.nGetLastNbLignesLogiquesParLignePhysiqueMoyen(),t,i,u;if(this.nGetNbRuptures()>0&&(t=this.m_nDebut,i=this.m_oCache.oGetLigne(t),i))for(u=n>i.vnGetLigneHTML()?1:-1;t>=0&&t<this.m_nNbLignes;){if(!i)break;if(i.vnGetLigneHTML()==n&&i.vnGetColonneHTML()==0){r=t;break}t+=u,i=this.m_oCache.oGetLigne(t)}return r},WDTable.prototype.DeplaceTable=function(n,t){var e,i,p,s,h;this.m_oCelluleSaisie&&this.m_oCelluleSaisie.bSaisieEnCours()&&this.m_oCelluleSaisie.SaisieFin(!0,!1,undefined,n),this.m_oDivPosParent.scrollTop="0px";var c=this.nGetAscenseurParentScrollTop(),o=Math.floor(c/this.nGetLastHauteurLigneMoyenne()),l=this.nGetDebutLogique(o);if(l!=this.m_nDebut||(this.SetDivPosTop(Math.floor(o*this.nGetLastHauteurLigneMoyenne()-c)),undefined!==t)){this.m_tabSelection.length>0&&this.m_tabSelection[0]!=-1&&this._vMasqueLigneInterne(this.nPosAbsolue2PosVisible(this.m_tabSelection[0]),!0,n),this.SetDebut(l);for(var a=!1,v=!1,w=this.m_oEtatLignes.nGetNbEtatLignes(),y=this.vnGetNbLignesLogiquesParLignePhysique(),r=this.m_nDebut,u,f=0;f<w;f++){for(e=this.oGetEtatLigne(f),i=0;i<y;i++,r++){if(r>=this.m_nNbLignes)break;if(u=this.m_oCache.oGetLigne(r),u&&u.vnGetColonneHTML()!=i){for(;i<y;i++)e.MasqueLigne(i,this,r,n);break}e.bMAJ(i,u,this,r,n,this.vbLigneEstSelectionneeSansZR(r)),p=e.bPlein(i),!p&&!u&&r<this.m_nNbLignes&&(v=!0)}if(r>=this.m_nNbLignes)break}this.m_oEtatLignes.Invalide(this,-1,f+1,!0,n),this.AfficheMasque(v,!1),this.m_oCache.SupprimeLignesInutiles(this),this.AnnuleTimeXXX("RemplitCacheDiff",!1),this.m_oCache.m_nDebutCache==-1?(this.m_bRequeteDiffereeForce=a,this.nSetTimeoutUnique("RemplitCacheDiff",300)):this.m_oCache.bRemplitCache(this,a,-1,this.m_bTriCroissant),this.MAJLignes(n),this.bGetHauteurLigneVariable()&&(s=this.m_oAscenseurParent.scrollHeight,h=this.m_oAscenseurParent.clientHeight,h<s&&s<=this.m_oAscenseurParent.scrollTop+h&&this.MAJAscenseur(!1,!0)),this.SetDivPosTop(Math.floor(o*this.nGetLastHauteurLigneMoyenne()-this.nGetAscenseurParentScrollTop()))}},WDTable.prototype.RemplitCacheDiff=function(){this.m_oCache.bRemplitCache(this,this.m_bRequeteDiffereeForce),delete this.m_bRequeteDiffereeForce},WDTable.prototype.OnRedimCol=function(n,t,i){this.m_oAffichageColonnes.bOnMouseDown(n,t,i)},WDTable.prototype.OnColonneLien=function(n,t,i){this.OnSelectLigne(this.nAbsolue2Relative(n),t,i,!0)},WDTable.prototype.OnSelectLigne=function(n,t,i,r){var u,l,e,o;if(this.m_nTypeSelection!=WDSelection.prototype.ms_nSelectionSans&&!(this.m_oCache.m_tabRequetes.length>0)&&(!this.m_oCelluleSaisie||!this.m_oCelluleSaisie.bSaisieEnCoursDansCellule(n,t))){if(this.m_bBloqueClickSurLigne){delete this.m_bBloqueClickSurLigne;return}if(u=this.nRelative2Absolue(n),!(u>=this.m_nNbLignes)){var s=i&&!r?i.ctrlKey:!1,h=i&&!r?i.shiftKey:!1,f=!1,c=this.m_nTypeSelection==WDSelection.prototype.ms_nSelectionSimple||r;if(!c&&(s||h)||(f=this.bLigneDeselectionneTous(u,i)),clWDUtil.nElementInconnu!=(l=this.nLigneSelectionne(u,i)))s&&(f=this.bLigneDeselectionne(l,i)),r&&(f=this.__bLigneSelectionne(u,!0,i));else{if(!c&&h&&this.m_tabSelection.length)for(e=this.nPosAbsolue2PosVisible(this.m_tabSelection[0]),o=e<u?1:-1,e+=o;e!=u;e+=o)f|=this.__bLigneSelectionne(e,!0,i);f|=this.__bLigneSelectionne(u,!0,i)}this.m_oCelluleSaisie&&this.m_oCelluleSaisie.OnClickCellule(n,t,f,i),(f||r)&&this.m_bRetourServeurSelection&&this.RequeteSelection(r?t:-1)}}},WDTable.prototype.OnTriColonne=function(n,t){var i;i=n==this.m_nColonneTrie?!this.m_bTriCroissant:!0,this.__TriColonne(n,i),this.m_oCache.bRemplitCache(this,!1,n,i),this.__InvalidePourTRF(t)},WDTable.prototype.__TriColonne=function(n,t){var i=this.m_nColonneTrie;this.m_nColonneTrie=n,this.m_bTriCroissant=t,this.m_oPopupSaisieTRF&&(-1!=i&&n!=i&&this.m_oPopupSaisieTRF.AfficheImageTri(i,undefined),this.m_oPopupSaisieTRF.AfficheImageTri(n,t))},WDTable.prototype.OnRecherche=function(n,t,i){this.m_oCache.CreeRequeteRecherche(this,t,i),this.__InvalidePourTRF(n)},WDTable.prototype.OnFiltre=function(n,t,i,r){this.m_oCache.CreeRequeteFiltre(this,t,i,r),this.__InvalidePourTRF(n)},WDTable.prototype.OnAnnuleFiltre=function(n,t){this.m_oCache.CreeRequeteAnnuleFiltre(this,t),this.__InvalidePourTRF(n)},WDTable.prototype._oGetColonne=function(n){return this.m_tabColonnes[n]},WDTable.prototype.__InvalidePourTRF=function(n){this.m_oEtatLignes.Invalide(this,this.m_nDebut,0,!1,n),this.AfficheMasque(!0,!0)},WDTable.prototype.eColonneTypeIDObjet=function(n){return this.m_tabColonnes[n].m_eTypeIDObjet},WDTable.prototype.bColonneSaisissable=function(n){return n>=this.m_tabColonnes.length||n<0?!1:this.m_tabColonnes[n].bGetSaisissable()},WDTable.prototype.nGetHauteurLigneRel=function(n){var t=-1,i;return this.bGetHauteurLigneVariable()&&(this.bGetSansLimite()?(i=this.oGetEtatLigne(n),t=i.m_oLignePhysique.offsetHeight+this._vnGetOffset(i.m_oLignePhysique)):t=this.__nGetHauteurLigne(this.nRelative2Absolue(n))),Math.max(t,this.m_nHauteurLigne)},WDTable.prototype._nGetNbColonnes=function(){return this.m_tabColonnes.length},WDTable.prototype.sGetValeurCellule=function(n,t){return this.m_oCache.oGetValeurCellule(this.nRelative2Absolue(n),t,!1)},WDTable.prototype.nGetValeurCellule=function(n,t){return this.m_oCache.oGetValeurCellule(this.nRelative2Absolue(n),t,!0)},WDTable.prototype.SetValeurCellule=function(n,t,i,r){this.bColonneSaisissable(t)&&this.m_oCache.SetValeurCellule(this.nRelative2Absolue(n),n,t,i,r)},WDTable.prototype.tabContenuCellule=function(n,t){var i=this.m_oCache.tabContenuCellule(this.nRelative2Absolue(n),t);return i?i:this.tabColonneCombo(t)},WDTable.prototype.oGetIDCelluleRel=function(n,t){return this.m_oEtatLignes.oGetCelluleHTML(this,n,t)},WDTable.prototype.bCreeLigneVirtuelle=function(n){return this.m_oCache.bCreeLigneVirtuelle(this.nRelative2Absolue(n))},WDTable.prototype.SupprimeLignesVirtuelles=function(){this.m_oCache.SupprimeLignesVirtuelles()},WDTable.prototype.ChangeOrdreColonne=function(n,t){this.m_oAffichageColonnes.LibereTitres(),this.__GenereLignesHTML(!0),this.bMAJNbLignesVisibles(!0,!1,!0),this.m_oAffichageColonnes.InitTitres(),this.m_oCache.CreeRequeteDeplaceColonne(this,t.m_nRangCreation,t.m_nPositionAffichage)},WDTable.prototype.nColonneLien=function(n){return n>=this.m_tabColonnes.length||n<0?WDTableAJAXColonne.prototype.m_nLien:this.m_tabColonnes[n].m_nLien},WDTable.prototype.nColonneEtatLien=function(n){return n>=this.m_tabColonnes.length||n<0?WDTableAJAXColonne.prototype.m_nEtatLien:this.m_tabColonnes[n].m_nEtatLien},WDTable.prototype.tabColonneCombo=function(n){return n>=this.m_tabColonnes.length||n<0?WDTableColonne.prototype.m_tabOptions:this.m_tabColonnes[n].m_tabOptions},WDTable.prototype.vPreMAJLigne=clWDUtil.m_pfVide,WDTable.prototype.vPostMAJLigne=clWDUtil.m_pfVide,WDTable.prototype.nGetLigneHTMLDebut=function(){return this.m_oCache.oGetLigne(this.m_nDebut).vnGetLigneHTML(this.m_nDebut)},WDTable.prototype.oGetEtatLigne=function(n){return this.m_oEtatLignes.oGetEtatLigne(n)},WDTable.prototype.NoteMAJLigne=function(n){if(this.__bLigneEstVisible(n)){var t=this.m_oCache.oGetLigne(n);t&&this.oGetEtatLigne(t.vnGetLigneHTML(n)-this.nGetLigneHTMLDebut()).Detache(t.vnGetColonneHTML())}},WDTable.prototype.MAJLigne=function(n,t){var i=this.m_oCache.oGetLigne(n);i&&(this.oGetEtatLigne(i.vnGetLigneHTML(n)-this.nGetLigneHTMLDebut()).bMAJ(i.vnGetColonneHTML(),i,this,n,t,this.vbLigneEstSelectionneeSansZR(n)),this._vPostMAJLignes())},WDTable.prototype.nPosAbsolue2PosVisible=function(n){return n!=-1?this.m_oCache.nPosAbsolue2PosVisible(n):-1},WDTable.prototype.nPosVisible2PosAbsolue=function(n){return n!=-1?this.m_oCache.nPosVisible2PosAbsolue(n):-1},WDTable.prototype.ValideChangement=function(n){this.m_oCache.ValideChangement(this,this.nRelative2Absolue(n))},WDCelluleAJAXSaisie.prototype=new WDCelluleSaisie,WDCelluleAJAXSaisie.prototype.constructor=WDCelluleAJAXSaisie,WDCelluleAJAXSaisie.prototype.m_nDiffClick=1e3,WDCelluleAJAXSaisie.prototype._vPrepareSaisieForceSurMAJDonnees=function(){this.m_oDateClick=new Date},WDCelluleAJAXSaisie.prototype._vbSaisieCommence=function(n,t){return this.m_nLigne==n&&this.m_nColonne==t&&+new Date-this.m_oDateClick.getTime()<this.m_nDiffClick},WDCelluleAJAXSaisie.prototype._voGetCellule=function(){return this.m_oChampTable.oGetIDCelluleRel(this.m_nLigne,this.m_nColonne)},WDCelluleAJAXSaisie.prototype._vSetEtat=function(){WDCelluleSaisie.prototype._vSetEtat.apply(this,arguments),this.m_oDateClick=new Date},WDCelluleAJAXSaisie.prototype._vClearEtat=function(){delete this.m_oDateClick,WDCelluleSaisie.prototype._vClearEtat.apply(this,arguments)},WDCelluleAJAXSaisie.prototype._vnGetHauteurLigne=function(){return this.m_oChampTable.nGetHauteurLigneRel(this.m_nLigne)},WDCelluleAJAXSaisie.prototype._vMAJLigne=function(n){n&&this.m_oChampTable.ValideChangement(this.m_nLigne),this.m_oChampTable.bMAJLigneRel(this.m_nLigne)},WDCelluleAJAXSaisie.prototype._vbCreeLigneVirtuelle=function(){return this.m_oChampTable.bCreeLigneVirtuelle(this.m_nLigne)},WDCelluleAJAXSaisie.prototype._vSupprimeLignesVirtuelles=function(){this.m_oChampTable.SupprimeLignesVirtuelles()},WDCelluleAJAXSaisie.prototype._vbAvecMasqueModele=function(){return!1}